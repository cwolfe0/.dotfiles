FU.prototype.Nqa=ga(222,function(a){this.O=Mb(arguments,0)});function R8b(a,b,c){return Kkb(a,y(function(){return this.C.calculateArrayFormulaResultPreview(b,c,0,0,!1,this.J,!0)},a))}function SV(a){Yi(this,a,0,-1,null)}z(SV,Xi);function S8b(a,b){var c=b.width;b=b.height;for(var d=a.width<=c?1:Math.floor(a.width/c),e=a.height<=b?1:Math.floor(a.height/b),g=[],h=0;h<d;h++)for(var k=a.left+h*c,l=0;l<e;l++){var m=a.top+l*b;g.push(new qh(m,k,m+b,k+c))}return g}var T8b=[2];
function U8b(a,b){var c=a.type;if(u(c))switch(c.toLowerCase()){case "checkbox":case "radio":a.checked=b;break;case "select-one":a.selectedIndex=-1;if(va(b))for(var d=0;c=a.options[d];d++)if(c.value==b){c.selected=!0;break}break;case "select-multiple":va(b)&&(b=[b]);for(d=0;c=a.options[d];d++)if(c.selected=!1,b)for(var e,g=0;e=b[g];g++)c.value==e&&(c.selected=!0);break;default:a.value=null!=b?b:""}}
function V8b(a){var b=a.type;if(!u(b))return null;switch(b.toLowerCase()){case "checkbox":case "radio":return a.checked?a.value:null;case "select-one":return b=a.selectedIndex,0<=b?a.options[b].value:null;case "select-multiple":for(var b=[],c,d=0;c=a.options[d];d++)c.selected&&b.push(c.value);return b.length?b:null;default:return u(a.value)?a.value:null}}function W8b(a){Yi(this,a,0,-1,null)}z(W8b,Xi);var X8b={Fmc:0,wya:1,fnc:2};function Y8b(a){Yi(this,a,0,-1,T8b)}z(Y8b,Xi);
function Z8b(a,b,c){function d(){g=ja.setTimeout(e,b);a.apply(null,k)}function e(){g=null;h&&(h=!1,d())}c&&(a=y(a,c));var g=null,h=!1,k=[];return function(a){k=arguments;g?h=!0:d()}}function $8b(a){for(var b=Math.random,c=a.length-1;0<c;c--){var d=Math.floor(b()*(c+1)),e=a[c];a[c]=a[d];a[d]=e}}function TV(a,b,c,d,e,g){K.call(this,a,b);this.C=b;this.Na=c;this.Pa=d||null;this.wb=e||null;this.F=g||null}z(TV,K);TV.prototype.Dj=f("Na");TV.prototype.Ve=f("Pa");
function a9b(a,b,c,d,e,g){TV.call(this,"assistant-sidepane-insert-chart",null,d,e,g);this.Y=a;this.$=b;this.fc=c}z(a9b,TV);a9b.prototype.Se=f("fc");function b9b(a){a=""+('<div class="waffle-assistant-feature-section"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+U(a.title)+"</div>"+U(jt({Oe:"waffle-assistant-section-more-button",content:cs("More"),style:4}))+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>');return V(a)};function UV(a,b,c){a&&(u(b)||(b=a.hasAttribute("title")?a.getAttribute("title"):""),b=Ua(b),it(a,b,void 0),T4b(a),a.setAttribute("data-tooltip-delay",500),U4b(a,u(c)?c:1))};function c9b(a,b,c){c=c||{};a=V;b='<div class="waffle-assistant-scroll-pane" style="'+(c.bb?"/*"+c.bb+"*/":"")+'display: none;"><div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-panel-pane">';c=c||{};c=V(""+('<div class="waffle-assistant-empty-list" style="'+(c.bb?"/*"+c.bb+"*/":"")+'display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>'));
return a(b+c+'<div class="waffle-assistant-panel-content-container"><div class="waffle-assistant-panel-card-holder"></div></div></div></div>')}function d9b(a){return V('<div class="waffle-assistant-panel-title-bar">'+U(jt({Oe:"waffle-assistant-panel-back-button",content:cs(""+U(Hu({icon:"docs-icon-img-container docs-explore-img docs-explore-back-white"}))),style:4}))+'<div class="waffle-assistant-title-text" role="heading">'+U(a.title)+"</div></div>")};function VV(a){pq.call(this,a);this.Vc=new LV(!1,"#4285f4");this.Ma(this.Vc);this.L=new pq(this.oa);this.Ma(this.L);this.D=[];this.Gg=this.Qc=!1;this.Yd=this.Bd=this.Ua=this.Y=null}z(VV,pq);q=VV.prototype;q.Sa=function(){VV.Z.Sa.call(this);this.Ba=Gr(c9b);this.Bd=T(this,"waffle-assistant-panel-content-container");this.Yd=T(this,"waffle-assistant-empty-list")};
q.Fa=function(){VV.Z.Fa.call(this);var a=T(this,"waffle-assistant-spinner-container");this.Vc.render(a);this.L.Va(T(this,"waffle-assistant-panel-card-holder"));this.getHandler().V(this.Ba,"scroll",Z8b(this.gVa,10,this))};q.setVisible=function(a){R(this.Ba,a);A(this.D,function(a){if(!a.rc()){var b=this.L.od();a.Y=b;this.L.Ma(a,!0);a.jO()}},this);this.Qc=a};
q.hqa=function(a,b){var c=this.oa;this.Y&&this.P4();this.Y=new pq;this.Ma(this.Y);a=Er(a,d9b,{title:b});this.Ua=new kt("",this.oa);this.Y.Ma(this.Ua);this.Ua.Va(tn(c,"waffle-assistant-panel-back-button",a));UV(this.Ua.Ba,"Back");this.Y.getHandler().V(this.Ua,"action",this.Phb)};q.P4=function(){this.Y.dispose();this.Y=null};function e9b(a,b){a.Vc.setActive(b);R(T(a,"waffle-assistant-panel-pane"),!b)}q.nL=function(a){R(this.Yd,a);R(this.Bd,!a)};
function f9b(a,b){Hb(a.D,b);a.L.removeChild(b);a.L.ri(b,0);a.D.push(b)}q.WK=function(a){Hb(this.D,a);-1!=yq(this.L,a)&&this.L.removeChild(a,!0)};q.Z3=function(){this.L.Qd(!0);Hc(this.D);this.D=[]};q.gVa=function(){for(var a=this.Ba,a=a.scrollTop+Vp(a).height,b=0,c=0;c<this.D.length;c++){var d=this.D[c];b<a?(WV(d,!0),b+=Vp(d.Ba).height):WV(d,!1)}};function g9b(a,b){a.Gg=b;A(a.D,function(a){a.uG(b)})}q.Id=f("Gg");q.Phb=function(){this.dispatchEvent("assistant-sidepane-back-button-clicked")};function XV(a,b,c,d){pq.call(this,d);this.R=a;this.Ya=b;this.X=new kt("",this.oa);this.Ma(this.X);this.J=new pq(this.oa);this.Ma(this.J);this.D=null;this.Ua=[];this.Na=this.La=!1;this.O=c}z(XV,pq);q=XV.prototype;q.kLa=Hf;q.vra=If;q.Sa=function(){XV.Z.Sa.call(this);this.Ba=Gr(b9b,{title:this.f1()})};
q.Fa=function(){XV.Z.Fa.call(this);this.J.Va(T(this,"waffle-assistant-section-card-holder"));this.X.Va(T(this,"waffle-assistant-section-more-button"));this.getHandler().V(this.X,"action",this.asb);this.D=this.vBa();H(this,this.D);R(h9b(this),this.kLa());this.setVisible(!1)};q.setVisible=function(a){if(this.rc()&&this.Ta()!=a&&(R(this.Ba,a),a)){R(this.X.Ba,this.wSa());a=new W8b;var b=this.Aca();P(a,4,b);b=new co;cj(b,58,a);this.O.Pb(2774,new Po(10,b))}};q.Ta=function(){return this.rc()&&Zp(this.Ba)};
q.wSa=function(){return this.Ua.length>this.R};q.f1=v;q.gW=v;q.vBa=function(){return new VV(this.oa)};q.g1=function(a){this.Na=a;A(i9b(this),function(b){b.uG(a)});g9b(this.D,a)};q.Id=f("Na");q.lh=ma;q.Q3=v;q.Aca=v;q.zta=function(a){this.Ua=a;for(var b=0;b<a.length;b++){Dc(a[b],1);if(this.J.od()<this.R){var c=this.gW(a[b]);c.uG(this.Na);var d=this.J.od();c.Y=d;this.J.Ma(c,!0)}if(this.vra()&&(this.D.nL(!1),c=this.D,d=this.gW(a[b]),c.D.push(d),c.Qc)){e9b(c,!1);var e=c.L.od();d.Y=e;c.L.Ma(d,!0);d.jO()}}};
function i9b(a){var b=[];a.J.vg(function(a){b.push(a)});return b}function h9b(a){return T(a,"waffle-assistant-section-content")}q.Bma=function(){return Gua(this.J)};q.e1=function(){this.Ua=[];Hc(this.J.Qd(!0));this.setVisible(!1);this.vra()&&(this.D.Z3(),this.D.nL(!0))};function j9b(a){a.J.vg(function(a,c){c<this.R&&a.jO()},a)}
q.Ata=function(a){var b=0;if(this.La)this.D.gVa();else if(this.Bma()){this.setVisible(!0);for(var b=Vp(T(this,"waffle-assistant-section-header")).height+Vp(h9b(this)).height,c=i9b(this),d=0;d<c.length;d++)b<a&&d<this.R?(this.rIa(c[d]),WV(c[d],!0),b+=Vp(c[d].Ba).height):WV(c[d],!1)}else this.setVisible(!1);return a-b};q.rIa=ma;q.setActive=function(a){(this.La=a)||this.D.P4()};q.Ob=f("La");function k9b(a,b){a.D.hqa(b,a.f1())}q.asb=function(){this.setActive(!0);this.dispatchEvent("assistant-sidepane-set-active-panel")};var l9b={UNKNOWN_ERROR:0,Vmc:1},m9b={Mmc:0,iC:1,$fc:2,Efc:3,Ohc:4},n9b={Jmc:0,Wfc:1,qH:2,Hdc:3},o9b={Dmc:0,qmc:1,j8b:2,Elc:3,Dlc:4};function YV(){B.call(this)}z(YV,B);var p9b=null;YV.prototype.xl=function(){return D(this,1)};function ZV(){B.call(this)}z(ZV,B);var q9b=null;ZV.prototype.getText=function(){return D(this,1)};ZV.prototype.qq=function(){return xc(this,1)};function $V(){B.call(this)}z($V,B);var r9b=null;$V.prototype.getStatus=function(){return D(this,1)};$V.prototype.hasFormula=function(){return xc(this,2)};$V.prototype.getError=function(){return D(this,9)};function aW(){B.call(this)}z(aW,B);var s9b=null;q=aW.prototype;
q.R8=function(){return xc(this,1)};q.hasFormula=function(){return xc(this,2)};q.getType=function(){return D(this,3)};q.Ed=function(a){F(this,3,a)};q.mf=function(){return xc(this,3)};YV.prototype.Ca=function(){var a=p9b;a||(p9b=a=Ec(YV,{0:{name:"Error",gb:"ritz.assistant.Error"},1:{name:"message",Aa:9,type:String},2:{name:"code",Aa:14,defaultValue:0,type:l9b}}));return a};YV.Ca=YV.prototype.Ca;
ZV.prototype.Ca=function(){var a=q9b;a||(q9b=a=Ec(ZV,{0:{name:"AnswerQueryPhrase",gb:"ritz.assistant.AnswerQueryPhrase"},1:{name:"text",Aa:9,type:String},2:{name:"start_byte",Aa:5,type:Number},3:{name:"num_bytes",Aa:5,type:Number}}));return a};ZV.Ca=ZV.prototype.Ca;
$V.prototype.Ca=function(){var a=r9b;a||(r9b=a=Ec($V,{0:{name:"AnswerResponse",gb:"ritz.assistant.AnswerResponse"},1:{name:"status",Aa:5,type:Number},10:{name:"parse_status",Aa:14,defaultValue:0,type:m9b},11:{name:"answer_status",Aa:14,defaultValue:0,type:n9b},2:{name:"formula",Aa:9,type:String},3:{name:"debug_parse_response",Aa:9,type:String},4:{name:"interpretation",Aa:9,type:String},5:{name:"debug_interpretation_response",Aa:9,type:String},6:{name:"unused_phrase",qd:!0,Aa:11,type:ZV},7:{name:"used_entity_phrase",
qd:!0,Aa:11,type:ZV},8:{name:"unused_entity_phrase",qd:!0,Aa:11,type:ZV},9:{name:"error",Aa:11,type:YV},12:{name:"alternate_suggestion",qd:!0,Aa:11,type:aW}}));return a};$V.Ca=$V.prototype.Ca;aW.prototype.Ca=function(){var a=s9b;a||(s9b=a=Ec(aW,{0:{name:"QuerySuggestion",gb:"ritz.assistant.QuerySuggestion"},1:{name:"query",Aa:9,type:String},2:{name:"formula",Aa:9,type:String},3:{name:"type",Aa:14,defaultValue:0,type:o9b}}));return a};aW.Ca=aW.prototype.Ca;function bW(){B.call(this)}z(bW,B);var t9b=null;bW.prototype.getChartType=function(){return D(this,1)};
bW.prototype.Ca=function(){var a=t9b;a||(t9b=a=Ec(bW,{0:{name:"AutovisRecommendationProto",gb:"ritz.assistant.AutovisRecommendationProto"},1:{name:"chart_type",Aa:9,type:String},2:{name:"chart_title",Aa:9,type:String},3:{name:"horizontal_axis_title",Aa:9,type:String},4:{name:"horizontal_axis_min",Aa:1,type:Number},5:{name:"horizontal_axis_max",Aa:1,type:Number},6:{name:"left_vertical_axis_title",Aa:9,type:String},7:{name:"left_vertical_axis_min",Aa:1,type:Number},8:{name:"left_vertical_axis_max",
Aa:1,type:Number},9:{name:"right_vertical_axis_title",Aa:9,type:String},10:{name:"right_vertical_axis_min",Aa:1,type:Number},11:{name:"right_vertical_axis_max",Aa:1,type:Number},12:{name:"columns_to_group_by",qd:!0,Aa:5,type:Number},13:{name:"column_aggregation_types",qd:!0,Aa:9,type:String},14:{name:"is_transposed",Aa:8,type:Boolean},15:{name:"use_first_column_as_domain",Aa:8,type:Boolean},16:{name:"first_data_row_index",Aa:5,type:Number},17:{name:"is_stacked",Aa:8,type:Boolean},18:{name:"autovis_range",
Aa:11,type:Od},19:{name:"text_analysis_words",qd:!0,Aa:9,type:String},20:{name:"text_analysis_word_counts",qd:!0,Aa:5,type:Number},21:{name:"mapped_column_label",qd:!0,Aa:9,type:String},22:{name:"best_facet_column",Aa:5,type:Number},23:{name:"best_facet_labels",qd:!0,Aa:9,type:String},24:{name:"needs_data_transformation",Aa:8,type:Boolean},25:{name:"data_transformation",Aa:11,type:bf}}));return a};bW.Ca=bW.prototype.Ca;var u9b={hea:0,Yca:1,v1:2,z2:3};function cW(){B.call(this)}z(cW,B);var v9b=null;q=cW.prototype;q.getName=function(){return D(this,1)};q.uh=function(a){F(this,1,a)};q.getType=function(){return D(this,4)};q.Ed=function(a){F(this,4,a)};q.mf=function(){return xc(this,4)};function dW(){B.call(this)}z(dW,B);var w9b=null;dW.prototype.getName=function(){return D(this,1)};dW.prototype.uh=function(a){F(this,1,a)};function eW(){B.call(this)}z(eW,B);var x9b=null;eW.prototype.$d=function(a){return D(this,2,a)};
eW.prototype.Ro=function(){return xc(this,2)};cW.prototype.Ca=function(){var a=v9b;a||(v9b=a=Ec(cW,{0:{name:"Dimension",gb:"ritz.assistant.Dimension"},1:{name:"name",Aa:9,type:String},2:{name:"filter",qd:!0,Aa:9,type:String},3:{name:"non_unique_filter",qd:!0,Aa:13,type:Number},4:{name:"type",Aa:14,defaultValue:0,type:u9b},5:{name:"year_only_dates",Aa:8,type:Boolean},6:{name:"density",Aa:1,type:Number},7:{name:"alt_name",qd:!0,Aa:9,type:String}}));return a};cW.Ca=cW.prototype.Ca;
dW.prototype.Ca=function(){var a=w9b;a||(w9b=a=Ec(dW,{0:{name:"Metric",gb:"ritz.assistant.Metric"},1:{name:"name",Aa:9,type:String},2:{name:"alt_name",qd:!0,Aa:9,type:String}}));return a};dW.Ca=dW.prototype.Ca;eW.prototype.Ca=function(){var a=x9b;a||(x9b=a=Ec(eW,{0:{name:"EntityListTable",gb:"ritz.assistant.EntityListTable"},1:{name:"metric",qd:!0,Aa:11,type:dW},2:{name:"dimension",qd:!0,Aa:11,type:cW},3:{name:"non_unique_dimension",qd:!0,Aa:13,type:Number}}));return a};eW.Ca=eW.prototype.Ca;var y9b={eZb:0,iH:1,P_b:2,EYb:3,aWa:4};function fW(){B.call(this)}z(fW,B);var z9b=null;function gW(){B.call(this)}z(gW,B);var A9b=null;gW.prototype.Pf=function(a){return D(this,4,a)};function hW(){B.call(this)}z(hW,B);var B9b=null;q=hW.prototype;q.getConfidence=function(){return D(this,2)};q.ah=function(){return D(this,3)};q.lJ=function(){return D(this,4,0)};q.getPivotTableDef=function(){return D(this,5)};q.pfa=function(){return Cc(this,7)};q.getAutovisRecommendation=function(){return D(this,8)};
function iW(){B.call(this)}z(iW,B);var C9b=null;fW.prototype.Ca=function(){var a=z9b;a||(z9b=a=Ec(fW,{0:{name:"AssistantResponseProto",gb:"ritz.assistant.AssistantResponseProto"},1:{name:"recommendation",qd:!0,Aa:11,type:hW},2:{name:"selection_recommendation",qd:!0,Aa:11,type:hW}}));return a};fW.Ca=fW.prototype.Ca;
gW.prototype.Ca=function(){var a=A9b;a||(A9b=a=Ec(gW,{0:{name:"AssistantRequestProto",gb:"ritz.assistant.AssistantRequestProto"},1:{name:"table_range",Aa:11,type:Od},2:{name:"selected_row",qd:!0,Aa:5,type:Number},3:{name:"selected_column",qd:!0,Aa:5,type:Number},4:{name:"color",qd:!0,Aa:11,type:pd},5:{name:"color_frequency",qd:!0,Aa:5,type:Number}}));return a};gW.Ca=gW.prototype.Ca;
hW.prototype.Ca=function(){var a=B9b;a||(B9b=a=Ec(hW,{0:{name:"RecommendationProto",gb:"ritz.assistant.RecommendationProto"},1:{name:"recommendation_type",Aa:14,defaultValue:0,type:y9b},2:{name:"confidence",Aa:1,type:Number},3:{name:"description",Aa:9,type:String},4:{name:"grid_ranges",qd:!0,Aa:11,type:Od},5:{name:"pivot_table_def",Aa:11,type:Ke},6:{name:"conditional_format_rules",qd:!0,Aa:11,type:Re},7:{name:"banding_protos",qd:!0,Aa:11,type:Cd},8:{name:"autovis_recommendation",Aa:11,type:bW},9:{name:"entity_list_table",
Aa:11,type:eW}}));return a};hW.Ca=hW.prototype.Ca;
iW.prototype.Ca=function(){var a=C9b;a||(C9b=a=Ec(iW,{0:{name:"AssistantFlagsProto",gb:"ritz.assistant.AssistantFlagsProto"},2:{name:"include_word_clouds",Aa:8,type:Boolean},3:{name:"include_conditional_formats",Aa:8,type:Boolean},4:{name:"include_forms_integration",Aa:8,type:Boolean},5:{name:"include_answers",Aa:8,type:Boolean},6:{name:"include_autovis_faceting",Aa:8,type:Boolean},7:{name:"include_banding",Aa:8,type:Boolean},9:{name:"include_autovis_sum",Aa:8,type:Boolean},10:{name:"include_already_applied_formatting_recommendations",
Aa:8,type:Boolean}}));return a};iW.Ca=iW.prototype.Ca;function D9b(){return V('<div class="waffle-assistant-card" tabindex="0" role="region">'+(cm?'<div class="waffle-assistant-card-feedback-container waffle-assistant-feedback-card-hidden"></div>':"")+'<div class="waffle-assistant-card-spinner-container"></div><div class="waffle-assistant-card-inner"><div class="waffle-assistant-button-holder waffle-assistant-card-options"></div><div class="waffle-assistant-card-content-container"></div>'+(cm?'<div class="waffle-assistant-thumbs-container"></div>':"")+
"</div></div>")};function jW(){}z(jW,DI);na(jW);jW.prototype.tc=n("waffle-assistant-link-button");function E9b(){return V('<div class="waffle-assistant-feedback-card waffle-assistant-feedback-card-hidden"><div class="waffle-assistant-feedback-card-content"><div class="waffle-assistant-feedback-card-text">Tell us what could be improved.</div><div class="waffle-assistant-feedback-card-link">Send feedback</div></div></div>')};function F9b(a,b){pq.call(this,b);this.D=a;this.C=new dt("",new jW,this.oa);this.Ma(this.C)}z(F9b,pq);q=F9b.prototype;q.Sa=function(){this.Ba=Gr(E9b)};q.Fa=function(){F9b.Z.Fa.call(this);var a=T(this,"waffle-assistant-feedback-card-link");this.C.Va(a);this.getHandler().V(this.Ba,"mousedown",this.LVb).V(this.C,"action",this.mnb);this.show(!1)};q.LVb=function(a){a.stopPropagation()};
q.show=function(a){var b=this.Ba,c=T(this,"waffle-assistant-feedback-card-link");Ap(b,"waffle-assistant-feedback-card-hidden",!a);kn(c,a)};q.mnb=function(){Q.Zw.Xb({source:this.D});this.show(!1);this.dispatchEvent(new K("feedback-dialog-opened"))};function kW(){}z(kW,bt);na(kW);kW.prototype.tc=n("waffle-assistant-button");function G9b(){var a;a=""+('<div class="waffle-assistant-thumbs"><div class="waffle-assistant-thumbs-text">Was this useful?</div><div class="waffle-assistant-thumbs-button-holder"><div class="waffle-assistant-thumbs-up-button">'+U(Hu({icon:"docs-icon-img docs-icon-thumb-up"}))+'</div><div class="waffle-assistant-thumbs-down-button">'+U(Hu({icon:"docs-icon-img docs-icon-thumb-down"}))+"</div></div></div>");return V(a)};function lW(a){pq.call(this,a);this.C=new dt("",new kW,this.oa);this.Ma(this.C);this.D=new dt("",new kW,this.oa);this.Ma(this.D)}z(lW,pq);lW.prototype.Sa=function(){this.Ba=Gr(G9b)};lW.prototype.Fa=function(){lW.Z.Fa.call(this);var a=T(this,"waffle-assistant-thumbs-down-button");this.C.Va(a);UV(a,"Not useful");a=T(this,"waffle-assistant-thumbs-up-button");this.D.Va(a);UV(a,"Useful");this.getHandler().V(this.C,"action",this.F).V(this.D,"action",this.J)};
function H9b(a,b){a.oa.Nf(T(a,"waffle-assistant-thumbs-text"),b)}lW.prototype.F=function(){this.dispatchEvent(new K("thumbs-down"));R(this.Ba,!1)};lW.prototype.J=function(){this.dispatchEvent(new K("thumbs-up"));R(this.Ba,!1)};function mW(a,b){pq.call(this,b);this.D=a;this.X=this.F=this.Y=null;this.Ya=new LV(!0,"#4285f4");this.Ma(this.Ya);this.eb=this.qc=this.Yd=!1;this.$=null;this.Gf=this.Rb=!1}z(mW,pq);q=mW.prototype;q.Xy=v;q.Qy=v;q.EMa=Hf;q.mT=Hf;q.S8=If;q.Lx=v;q.dE=Jf;q.cE=Jf;q.m7=Jf;q.Wja=Jf;q.Vja=Jf;q.uG=ea("Gf");q.Id=f("Gf");q.r8=ma;q.Sa=function(){this.Ba=Gr(D9b)};
q.Fa=function(){mW.Z.Fa.call(this);var a=T(this,"waffle-assistant-card-spinner-container");this.Ya.render(a);Dp(T(this,"waffle-assistant-card-inner"),"visibility","hidden");if(this.mT()){var a=this.Ba,b=new oq(a);H(this,b);this.getHandler().V(b,"focusin",this.uib).V(b,"focusout",this.tib).V(a,"mouseenter",this.cma).V(a,"mouseleave",this.x8)}I9b(this,!1);this.S8()&&cm?(this.X=new F9b(this.Lx(),this.oa),this.X.render(T(this,"waffle-assistant-card-feedback-container")),this.F=new lW(this.oa),this.F.render(T(this,
"waffle-assistant-thumbs-container")),J9b(this,!0),a=Qa(this.m7()),Oa(a)||H9b(this.F,a),a=Qa(this.Wja()),Oa(a)||UV(T(this.F,"waffle-assistant-thumbs-up-button"),a),a=Qa(this.Vja()),Oa(a)||UV(T(this.F,"waffle-assistant-thumbs-down-button"),a),this.getHandler().V(this.F,"thumbs-down",this.JVb).V(this.F,"thumbs-up",this.KVb).V(this.X,"feedback-dialog-opened",this.nnb).V(this,"trigger_feedback",this.OPb)):J9b(this,!1);this.Qy()};function nW(a){return T(a,"waffle-assistant-card-content-container")}
function K9b(a){a.mT();return T(a,"waffle-assistant-card-options")}function J9b(a,b){cm&&R(T(a,"waffle-assistant-thumbs-container"),a.S8()&&b)}q.jO=function(){this.isDisposed()||(this.Yd=!0,L9b(this))};function WV(a,b){!a.qc&&b&&(a.qc=!0,L9b(a))}function L9b(a){if(a.Yd&&a.qc){var b=y(a.IVb,a);a.Xy(b)}}q.cma=function(){this.eb||(I9b(this,!0),this.eb=!0,$k(this.$),this.$=Zk(this.EAa,100,this))};
q.EAa=function(){this.isDisposed()||($k(this.$),this.$=null,this.Ba.parentNode.querySelector(":hover")==this.Ba?this.$=Zk(this.EAa,100,this):this.x8())};q.x8=function(){I9b(this,!1);this.eb=!1};q.uib=function(){I9b(this,!0)};q.tib=function(){Zk(function(){this.isDisposed()||en(this.Ba,document.activeElement)||this.Ba.parentNode.querySelector(":hover")==this.Ba||I9b(this,!1)},0,this)};
q.JVb=function(){M9b(this,!0);J9b(this,!1);var a=this.cE();this.dispatchEvent(new TV("assistant-sidepane-thumbs",this,a))};q.KVb=function(){J9b(this,!1);var a=this.dE();this.dispatchEvent(new TV("assistant-sidepane-thumbs",this,a))};q.nnb=function(){M9b(this,!1)};q.OPb=function(){M9b(this,!0)};function I9b(a,b){var c=T(a,"waffle-assistant-card-options");a=a.mT();R(c,a&&b)}q.IVb=function(){this.Ya.setActive(!1);R(this.Ya.Ba,!1);Dp(T(this,"waffle-assistant-card-inner"),"visibility","visible");this.dispatchEvent(new K("content-rendered"))};
function M9b(a,b){Ap(T(a,"waffle-assistant-card-feedback-container"),"waffle-assistant-feedback-card-hidden",!b);a.X.show(b)};function N9b(){return V('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview"  tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function O9b(){return V(U(jt({Oe:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:cs(""+U(Hu({icon:"docs-icon-img docs-icon-insert-autovis-chart"}))),style:4}))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+U(jt({Oe:"waffle-assistant-zoom-button",content:cs(""+U(Hu({icon:"docs-icon-img docs-icon-zoom-in"}))),style:4})))};function P9b(a){var b="",c='By <span class="waffle-assistant-facet-title">'+(U(a.e3a)+"</span>"),d=0==a.KEa.length,b=b+('<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">'+c+'</div><div class="waffle-assistant-facet-toggle"></div></div>');if(d)c=V('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{c='<div class="waffle-assistant-facet-charts-container">\x3c!-- Create chart containers with two in each row. --\x3e';a=a.KEa;for(var e=a.length,g=0;g<e;g++)var h=a[g],c=c+((0==g%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">'),c=h?c+U(h):c+"(empty)",c=c+('</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==g%2||g==e-1?"</div>":""));c=V(c+"</div>")}b+='<div class="waffle-assistant-facet-content-wrapper'+
(d?" waffle-assistant-facet-white-section":"")+'">'+c+(cm?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return V(b)};function Q9b(a,b,c,d,e,g,h){pq.call(this,h);this.F=a;this.D=b;this.L=e;this.J=g;this.C=this.fc=null;this.Uc=Ro(new Qo,10).Ga()}z(Q9b,pq);q=Q9b.prototype;q.Fa=function(){Q9b.Z.Fa.call(this);(new nV(PH,this.D.Sg)).send(y(this.Hkb,this,this.D))};q.r8=function(a,b){a=new a9b(this.F.clone(),this.L,this.fc,2746,a,b);this.dispatchEvent(a)};q.Hkb=function(a,b){b&&(b=b.Se(),a.Ef(b),BV(a,b),pH(a,"ready",y(this.BVb,this,a)),IV(a,this.Ba,mm),this.fc=b)};
q.BVb=function(a){a.Ql()&&(pH(a.Ql(),"onmouseover",y(this.zVb,this)),pH(a.Ql(),"onmouseout",y(this.AVb,this)))};q.zVb=function(){this.C=Fa()};q.AVb=function(){ya(this.C)&&500<Fa()-this.C&&this.J.Pb(2750,this.Uc);this.C=null};function R9b(a,b,c,d,e){pq.call(this,e);this.F=a;this.Da=b;this.J=c;this.R=d;this.L=Cc(this.F,23);this.ea=D(this.F,22);this.O=Cc(this.F,21)[this.ea];this.$=[];this.La=new Ii;this.X=this.D=this.C=null;this.Y=!1;this.Uc=Ro(new Qo,10).Ga()}z(R9b,pq);q=R9b.prototype;q.Sa=function(){R9b.Z.Sa.call(this);this.Ba=Gr(P9b,{e3a:this.O,KEa:this.L});this.Ba.style.visibility="hidden"};
q.Fa=function(){R9b.Z.Fa.call(this);this.getHandler().V(this.Ba,"mousedown",this.wVb).V(T(this,"waffle-assistant-facet-toggle"),"mousedown",this.Ozb);cm&&(this.X=new F9b("assistantAutovisFacetFeedback",this.oa),this.X.render(T(this,"waffle-assistant-facet-feedback-container")),this.C=new lW(this.oa),this.Ma(this.C),this.C.render(T(this,"waffle-assistant-facet-thumbs-container")),H9b(this.C,this.L.length?"Were these charts useful?":"Was this chart useful?"),this.getHandler().V(this.C,"thumbs-up",this.yVb).V(this.C,
"thumbs-down",this.xVb));S9b(this,!0)};q.Id=f("Y");q.wVb=function(a){a.stopPropagation()};q.Ozb=function(){var a=vp(T(this,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");S9b(this,a);this.J.Pb(a?2647:2646,this.Uc)};function S9b(a,b){hn(T(a,"waffle-assistant-facet-toggle"),b?"HIDE":"SHOW");Ap(T(a,"waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);a.C&&R(a.C.Ba,b)}
function T9b(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}function U9b(a){"BarChart"==a.getChartType()&&a.setOption("isStacked",!0)}
function V9b(a){a.R&&!a.Y&&A(a.$,y(function(a){var b=a.Ba;if(!this.R.contains(b)){var d=this.R;a=new W9b(b,a);Qhb(d,a)}},a))}q.yVb=function(){this.J.Pb(2649,this.Uc)};q.xVb=function(){this.J.Pb(2648,this.Uc);this.X.show(!0)};function oW(a,b,c,d,e,g){mW.call(this,a,g);this.C=a.getAutovisRecommendation();this.$e=b;this.Je=c;this.R=d;this.Ua=e;this.O=new kt("",this.oa);this.Ma(this.O);this.Za=new kt("",this.oa);this.Ma(this.Za);this.Ke=new Ii;this.Bd=null;this.La=!1;this.Vc=[];this.Qc=[];this.Gb=[];this.Na=this.Da=this.J=this.L=this.ea=null;this.Uc=Ro(new Qo,10).Ga()}z(oW,mW);
var X9b={options:{hAxis:{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},vAxes:[{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0},{titleTextStyle:{color:"#757575",italic:!1},useFormatFromData:!0}],fontName:"Roboto",legacyContinuousAxisRemoved:!0,booleanRole:"certainty",theme:"material",width:null,height:null}},Y9b=["BarChart","ColumnChart"],pW={HVa:"waffle-assistant-after-chart-preview",dWa:"waffle-assistant-before-chart-preview",qWa:"waffle-assistant-card-draggable",
e2:"waffle-assistant-chart-highlights",CYa:"waffle-assistant-insert-chart-button",Rda:"waffle-assistant-chart-preview",n_a:"waffle-assistant-button-separator",J_a:"waffle-assistant-styled-border",K_a:"waffle-assistant-styled-rect",I0a:"waffle-assistant-zoom-button"};q=oW.prototype;q.Xy=function(a){this.Bd=a;Z9b(this)};q.Qy=function(){$9b(this,y(function(a){a=i8b(this.$e,a);tp(this.Ba,a)},this),!1)};q.EMa=If;q.mT=If;q.Lx=n("autovisFeedback");q.dE=n(2208);q.cE=n(2207);q.m7=n("Was this chart useful?");
q.Sa=function(){oW.Z.Sa.call(this);nW(this).appendChild(Gr(N9b));K9b(this).appendChild(Gr(O9b));if(xc(this.C,22)){this.J=new R9b(this.C,this.Y,this.R,this.Ua,this.oa);this.Ma(this.J,!0);var a=this.J,b=this.Id();a.Y=b;V9b(a)}};
q.Fa=function(){oW.Z.Fa.call(this);wp(this.Ba,pW.qWa);var a=T(this,pW.CYa);this.O.Va(a);UV(a,"Insert chart");a=T(this,pW.I0a);this.Za.Va(a);UV(a,"View full size");var a=T(this,pW.dWa),b=T(this,pW.Rda),c=T(this,pW.HVa);this.getHandler().V(this.Ba,"keydown",this.tVb).V(b,"click",this.$ib).V(a,"focus",this.Xhb).V(c,"focus",this.Tgb).V(this.O,"action",this.Gpb).V(this.O.Ba,"mousedown",this.yta).V(this.Za,"action",this.xBb).V(this.Za.Ba,"mousedown",this.yta).V(T(this,pW.e2),"mousedown",this.yta).V(nw(this.$e),
"Ib",this.uVb);a$b(this);this.R.Pb(2790,this.Uc);this.J&&this.R.Pb(2791,this.Uc)};q.uG=function(a){oW.Z.uG.call(this,a);a$b(this);this.rc()&&b$b(this)};function a$b(a){if(a.rc()){var b=a.Id();a.O.setVisible(!b);a=tn(a.oa,pW.n_a,K9b(a));R(a,!b)}}q.tVb=function(a){13==a.keyCode&&a.target==this.Ba&&(a.preventDefault(),a.stopPropagation(),c$b(this,2255))};
function d$b(a){for(var b=a.getChartType(),c=!!D(a.C,14),d=D(a.C,16),e=!!D(a.C,15),g="Histogram"==b,h="PieChart"==b,k=qW(a),l=1<k.length,m=[],b=0;b<k.length;b++){var p=e$b(k[b].rect,c!=h);Lb(m,p)}var b=Xz(a.Je).ud(),r=tb(fc(Vg),b.d1,b),c=tb(m,function(a){return tb(r,Da(uh,a))});g&&e&&(c=Mb(c,1));a.Gb=f$b(c.length,h&&0<d||!g&&!h&&e,h&&l);d=Xz(a.Je);for(b=0;b<c.length;b++)for(e=a.Gb[b],g=0;g<c[b].length;g++)c[b][g]&&Gh(c[b][g])&&(h=OT(d,c[b][g],pW.K_a),H(a,h),zF(kI(d),h,!0),Dp(h.Ba,"background-color",
e),h.setVisible(!0),a.Vc.push(h),h=RH(d,c[b][g],pW.J_a,1,0),H(a,h),JXa(h,e),h.setVisible(!0),a.Qc.push(h))}function g$b(a){Hc(a.Vc);Hc(a.Qc);a.Vc=[];a.Qc=[];a.Gb=[]}q.uVb=function(){this.La&&(g$b(this),d$b(this))};q.cma=function(){oW.Z.cma.call(this);this.Da=Fa();this.La||(d$b(this),this.La=!0)};q.x8=function(){oW.Z.x8.call(this);ya(this.Da)&&500<Fa()-this.Da&&this.R.Pb(2789,this.Uc);this.Da=null;g$b(this);this.La=!1};q.$ib=function(){this.Ba.focus()};
q.Xhb=function(){var a=T(this,pW.e2);if(Zp(a))a.focus();else{if(a=this.F)a=T(this.F,"waffle-assistant-thumbs-up-button"),Zp(a)?(a.focus(),a=!0):a=!1;a||this.O.Ba.focus()}};q.Tgb=function(){var a;if(a=this.X)a=this.X,T(a,"waffle-assistant-feedback-card-hidden")?a=!1:(T(a,"waffle-assistant-feedback-card-link").focus(),a=!0);a||this.Ba.focus()};q.Gpb=function(){this.R.Pb(2255,this.Uc);c$b(this,2255)};q.yta=function(a){a.stopPropagation()};q.xBb=function(){X.u1.Xb(this)};
q.r8=function(a,b){c$b(this,2257,a,b)};function c$b(a,b,c,d){$9b(a,y(function(a){a=new a9b(a,this.Y,this.L&&this.L.Se(),b,c,d);this.dispatchEvent(a)},a),!1)}
q.vVb=function(a,b){if(b){a.Ef(b.Se());BV(a,a.Se());gU(a,"ready",y(this.sVb,this,a));b=[];try{var c=new af;c.setContext(a.toJSON());var d=!!D(this.C,14);F(c,3,d);var e=D(this.C,16);F(c,4,e);F(c,5,"ROWS"==(d?"ROWS":"COLS"));F(c,8,0);var g;if(D(this.C,24)){g=[LT(D(this.C,18))];var h=D(this.C,25);F(c,9,h)}else g=qW(this);for(d=0;d<g.length;d++)c.addRange(Mh(g[d].rect,g[d].xd));var k=this.Ke.serialize(c);b=tb(q8b(Da(ritz.getVerbalHighlightsForProto,k),a).call(),n8b)}catch(l){b=[]}c=T(this,pW.e2);R(c,
0<b.length);0<b.length&&(c.appendChild(b[0]),kn(c,!0));this.L=a;IV(a,T(this,pW.Rda),mm)}};q.sVb=function(a){null!==this.ea&&(xJ(vJ.getInstance(),this.ea),this.ea=null);this.isDisposed()||(a.Ql()&&(pH(a.Ql(),"onmouseover",y(this.qVb,this)),pH(a.Ql(),"onmouseout",y(this.rVb,this))),this.Bd(),b$b(this))};q.qVb=function(){this.Na=Fa()};q.rVb=function(){ya(this.Na)&&500<Fa()-this.Na&&this.R.Pb(2795,this.Uc);this.Na=null};
function b$b(a){if(a.Ua&&!a.Id()){var b=T(a,pW.Rda);if(!a.Ua.contains(b)){var c=a.Ua;a=new W9b(b,a);Qhb(c,a)}}}
function h$b(a){a.Rb&&(a.ea=wJ(vJ.getInstance(),ij.cua),a.Rb=!1);var b=new AH(rc(X9b)),c=a.C.getChartType(),d=D(a.C,16),e=!!D(a.C,14),e=1<qW(a).length||!e&&1<qW(a)[0].rect.width||e&&1<qW(a)[0].rect.height;("PieChart"==c&&!e||"PieChart"!=c&&0>=d)&&b.setOption("legend.position","none");b.setOption("title",D(a.C,2));b.setOption("hAxis.title",D(a.C,3));xc(a.C,4)&&b.setOption("hAxis.viewWindow.min",D(a.C,4));xc(a.C,5)&&b.setOption("hAxis.viewWindow.max",D(a.C,5));b.setOption("vAxes.0.title",D(a.C,6));
xc(a.C,7)&&b.setOption("vAxes.0.viewWindow.min",D(a.C,7));xc(a.C,8)&&b.setOption("vAxes.0.viewWindow.max",D(a.C,8));b.setOption("vAxes.1.title",D(a.C,9));xc(a.C,10)&&b.setOption("vAxes.1.viewWindow.min",D(a.C,10));xc(a.C,11)&&b.setOption("vAxes.1.viewWindow.max",D(a.C,11));b.setOption("useFirstColumnAsDomain",D(a.C,15));b.setOption("isStacked",D(a.C,17));b.setOption("treatLabelsAsText",zb(Y9b,c));b.Ah(c);d=Cc(a.C,12);if(!D(a.C,24)&&d&&d.length)if(b.setOption("applyAggregateData",0),d=Cc(a.C,13),"PieChart"===
c)b.setOption("aggregateFunction",d[0]);else for(c=0;c<d.length;c++)b.setOption("series."+c+".aggregateFunction",d[c]);b.Uaa(PH);c=qW(a);d=!!D(a.C,14);e=D(a.C,16)||0;d=Bl(c3a("/gviz/tq"),"").hb("transpose",d?"1":"0").hb("headers",e.toString()).hb("hds",0).hb("merge",d?"ROWS":"COLS").hb("authkey",pm("authKey"));D(a.C,24)&&(c=[LT(D(a.C,18))],d.hb("dt",encodeURIComponent(JSON.stringify(a.Ke.serialize(D(a.C,25))))));h3a(d,c);b.Ii(d.toString());a.J&&(c=d.clone(),a.J.D=c);return b}
function Z9b(a){var b=h$b(a);b.setOption("legend.position","none");b.setOption("hAxis.slantedText",0);b.setOption("hAxis.textStyle.fontSize",11);b.setOption("vAxes.0.textStyle.fontSize",11);b.setOption("vAxes.1.textStyle.fontSize",11);b.setOption("fontStyle.size",10);b.setOption("fontStyle.italic",!1);b.setOption("titleTextStyle.bold",!1);b.setOption("titleTextStyle.fontSize",12);b.setOption("async",40);!1!==b.Ub("useFirstColumnAsDomain")&&b.Se()&&"number"===b.Se().$c(0)&&b.setOption("hAxis.gridlines.count",
-1);var c=15;if(!1!==b.Ub("useFirstColumnAsDomain")&&b.Se()&&"string"===b.Se().$c(0)){var c=0,d=Rm("span");d.style.fontSize="11px";d.style.fontFamily="Roboto,Arial";T(a,"waffle-assistant-card-inner").appendChild(d);for(var e=0;e<b.Se().getNumberOfRows();e++)hn(d,b.Se().zf(e,0)),c=Math.max(c,cq(d).width);Ym(d);c=Math.min(27,Math.max(15,10+100*c/271))}b.setOption("chartArea.top","15%");d=b.Ub("hAxis.title");b.setOption("chartArea.height",Oa(Qa(d))?"80%":"65%");b.setOption("chartArea.left",c+"%");b.setOption("chartArea.width",
95-c+"%");"PieChart"==b.getChartType()&&(b.setOption("chartArea.top",Oa(Qa(b.Ub("title")))?"12%":"15%"),b.setOption("chartArea.height","70%"),b.setOption("chartArea.left","0%"),b.setOption("chartArea.width","100%"),b.setOption("pieSliceText","none"),b.setOption("legend.position","labeled"),b.setOption("legend.textStyle.fontSize",10));(new nV(PH,b.Sg)).send(y(a.vVb,a,b));a.J&&$9b(a,y(function(a){var b=this.J,c=new AH(a.toJSON()),d=rq(b,"waffle-assistant-faceted-chart");1<d.length?(U9b(a),T9b(c),c.setOption("axisFontSize",
0),c.setOption("hAxis.title",null),c.setOption("hAxis.textPosition","none"),c.setOption("vAxes.0.title",null),c.setOption("vAxes.0.textPosition","none"),c.setOption("vAxes.1.title",null),c.setOption("vAxes.1.textPosition","none"),c.setOption("chartArea",{left:"5%",top:"5%",width:"90%",height:"90%"}),c.setOption("legend","none"),c.setOption("titleTextStyle.fontSize",0)):(U9b(a),a.setOption("applyAggregateData",void 0),a.setOption("legend","right"),T9b(c));var e=LT(D(b.F,18));h3a(b.D,[e]);for(var e=
D(b.F,25),g=0;g<d.length;g++){var r=b.L[g]||null,t=e.clone(),w=t,x=b.ea,C=r,E=new ff;F(E,1,x);va(C)&&E.Wa(C);F(w,7,E);b.D.hb("dt",encodeURIComponent(JSON.stringify(b.La.serialize(t))));t=new AH(a.toJSON());t.Ii(b.D.toString());w=c.clone();w.Ii(b.D.toString());x=b;E=t.Ub("title");C=E+(' when "'+(x.O+('" is "'+(r+'"'))));x=E+(' by "'+(x.O+'"'));r=r?C:x;t.setOption("title",r);w.setOption("title",r);r=new Q9b(t,w,0,0,b.Da,b.J,b.oa);b.Ma(r);r.Va(d[g]);b.$.push(r)}V9b(b);b.Ba.style.visibility="visible"},
a),!1)}function $9b(a,b,c){var d=h$b(a);(new nV(PH,d.Sg)).send(function(a){a?(a=a.Se(),c&&d.Ef(a),BV(d,a),b(d)):b(null)})}function qW(a){a=Cc(a.D,4);for(var b=[],c=0;c<a.length;c++)b.push(LT(a[c]));return b}q.getChartType=function(){return this.C.getChartType()};function f$b(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=w6b("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Lb(d,d);return d}function e$b(a,b){return b?S8b(a,new hh(a.width,1)):S8b(a,new hh(1,a.height))};function i$b(){sL.call(this);this.Ka.push(this);this.va=this.ea=!0;this.Na="waffle-assistant-dragged-card"}z(i$b,Phb);i$b.prototype.contains=function(a){return!!A(this.J,function(b){if(b.element==a)return!0})};i$b.prototype.qka=function(a){var b=i$b.Z.qka.call(this,a);if(c5b()||mm){a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0)}else a=tb(b.querySelectorAll("clippath"),function(a){return a.id}),j$b(b,a);return b};
function j$b(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];va(c)&&ab(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=$m(a);for(d=0;d<a.length;d++)j$b(a[d],b)}function W9b(a,b){uL.call(this,a,b)}z(W9b,uL);W9b.prototype.ska=f("element");function k$b(){return V('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')};function rW(a,b){mW.call(this,a,b);this.C=a.getAutovisRecommendation()}z(rW,mW);q=rW.prototype;q.Qy=ma;q.Lx=n("assistantWordCloudFeedback");q.dE=n(2634);q.cE=n(2633);q.Sa=function(){rW.Z.Sa.call(this);nW(this).appendChild(Gr(k$b));wp(nW(this),"waffle-assistant-word-cloud-content-container")};
q.Xy=function(a){for(var b=Cc(this.C,19),c=Cc(this.C,20),d=T(this,"waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(this.Ik(b,c,e),120<d.clientHeight){this.Ik(b,c,e-1);break}b=this.oa;c=D(this.C,2);c=wn(b,c);d=T(this,"waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
q.Ik=function(a,b,c){for(var d=T(this,"waffle-assistant-word-cloud-words-container"),e=this.oa;d.firstChild;)d.removeChild(d.firstChild);for(var g=b[c],h=b[0],k=0;k<=c;k++){0!=k&&d.appendChild(wn(e," "));var l=e.createElement("SPAN");e.appendChild(l,wn(e,a[k]));e.appendChild(d,l);wp(l,"waffle-assistant-word-cloud-word");var m=b[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(m-g)/(h-g)*15+9+"px"}};function sW(a,b,c,d,e){XV.call(this,20,d,c,e);this.ea=a;this.$=b;this.C=new i$b;H(this,this.C);this.F=null;this.Y=0}z(sW,XV);q=sW.prototype;q.Fa=function(){sW.Z.Fa.call(this);this.C.We();this.getHandler().V(this.C,"drag",this.pVb).V(this.C,"dragend",this.oVb)};q.f1=n("Analysis");q.Q3=function(a){return 0==a};q.gW=function(a){return"WordCloud"==a.getAutovisRecommendation().getChartType()?new rW(a,this.oa):new oW(a,this.ea,this.$,this.O,this.C,this.oa)};q.g1=function(a){sW.Z.g1.call(this,a);a&&xhb(this.C)};
q.rIa=function(a){Df(this.getHandler(),a,"content-rendered",this.nVb);this.Y++};q.nVb=function(){0==--this.Y&&this.dispatchEvent("assistant-done-rendering")};q.pVb=function(){this.F=Rp(this.C.Xc.target)};q.oVb=function(a){var b=this.F,c=Xz(this.$).C;if(mh(sE(c,"page",!1,!1)).contains(b)){var d=qE(c,b.x,b.y,"page"),c=uE(c,sh(d),"page"),b=new N(b.x-c.left,b.y-c.top);a.C.getData().r8(d,b)}this.F=null};q.Aca=n(2);function tW(a,b,c,d){this.C=a;this.Sea=b;this.Kn=(this.F=c)?D(c,2):null;this.L=c?Cc(c,6):[];this.O=c?Cc(c,7):[];this.J=c?Cc(c,8):[];this.error=d||1;this.interpretation=poa&&c&&xc(c,4)?D(c,4):null;this.D=qoa&&c?Cc(c,12):[]}function l$b(a){return{iS:m$b(a),interpretation:a.interpretation,Sea:a.Sea,Kn:a.Kn}}function n$b(a){return{iS:m$b(a),error:o$b(a)}}
function o$b(a){switch(a.error){case 2:return"Looks like you are offline. Try again when you reconnect.";case 3:return"There was a problem getting your answer. Please try again.";case 4:return"Sorry, couldn't understand your question.";case 5:return"Answers lets you ask question and learn more about you data.";case 6:return a.F.getError().xl()||""}return""}
function m$b(a){var b=[];if(ooa&&1==a.error&&null!=a.Kn){var c=[];A(Jb(a.L,a.J),function(a){c.push(p$b(a,"waffle-assistant-answercard-question-unused-phrase"))},a);A(a.O,function(a){c.push(p$b(a,"waffle-assistant-answercard-question-used-entity"))},a);Sb(c,function(a,b){return a.MB>b.MB?1:-1});var d=0;A(c,function(a){a.MB>d&&b.push({text:this.C.substring(d,a.MB),className:null});d=a.MB+a.length;b.push({text:this.C.substring(a.MB,d),className:a.rk})},a);d<a.C.length&&b.push({text:a.C.substring(d),
className:null})}else b.push({text:a.C,className:null});return b}function p$b(a,b){return{MB:D(a,2),length:D(a,3),rk:b}};function uW(a,b,c,d){L.call(this);this.X=a;this.Y=b;this.$=c;this.Ka=d;this.qa=new M(this);H(this,this.qa);this.C=new FU;H(this,this.C);this.R="";this.O=[];this.F=this.D=this.L=null;this.J=!1;A5b(this.C,this.X);this.C.X=10;this.C.ea=!0;this.C.L=!1;this.C.Nqa("waffle-assistant-visible");this.C.R=Ua("waffle-assistant-dragged-formula").split(" ");this.C.We();this.qa.V(this.C,"beforedragstart",this.ea).V(this.C,"dragmove",this.Ha).V(this.C,"beforedragend",this.va)}z(uW,L);
uW.prototype.ea=function(a){a=qb(this.X.childNodes,a.C);this.R=this.O[a]};
uW.prototype.Ha=function(a){var b=a.event instanceof nq?a.event.C:a.event;this.J?(a.Y.ew(b,!0),a.preventDefault()):(Jp(a.F,a.event.clientX,a.event.clientY),a=Kp(a.F),b=Xz(this.Y).C,mh(sE(b,"page",!1,!1)).contains(a)?(a=qE(b,a.x,a.y,"page"),(b=Xw(pw(this.$),a.y,a.x))?a=new N(b.bc(),b.hc()):b=sh(a),this.L=a,this.D&&this.D.Ac().equals(b)||(a=Xz(this.Y),J(this.D),this.D=OT(a,b,"waffle-assistant-formula-insertion-rect"),H(this,this.D),zF(kI(a),this.D),J(this.F),this.F=RH(a,b,"waffle-assistant-formula-insertion-border",
2,0),H(this,this.F),JXa(this.F,"#000"),this.F.setVisible(!0))):q$b(this))};uW.prototype.va=function(a){if(this.L){var b=this.L,c=pw(this.$),b=new KE(c,b,this.R);this.Ka.C(b);this.dispatchEvent(new K("formula_inserted"))}a.Y.ew(null,!0);a.preventDefault();this.R="";q$b(this)};function q$b(a){a.L=null;J(a.D);a.D=null;J(a.F);a.F=null};function r$b(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+s$b({iS:a.w3.iS}),d;d=a.w3.Sea;var e=a.w3.Kn;a=a.w3.interpretation;null==d||qa(d);a=""+('<div class="waffle-assistant-answercard-answer-container"><div class="waffle-assistant-answercard-answer-header" role="heading" aria-label="'+fs("Answer")+'"><span aria-hidden="true">Answer</span></div>'+(a?'<div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret">'+
U(a)+"</div></div>":"")+'<div class="waffle-assistant-answercard-answer-content">');if(d){a+='<div class="waffle-assistant-answercard-answer">';for(var g=d.length,h=0;h<g;h++){var k=d[h];if(0==h&&1<k.length){a+='<div class="waffle-assistant-answercard-answer-rowheader">';for(var l=k.length,m=0;m<l;m++)a+='<span class="waffle-assistant-answercard-answer-col">'+U(k[m])+"</span>"}else for(a+='<div class="waffle-assistant-answercard-answer-row">',l=k.length,m=0;m<l;m++){var p=k[m];a=p?a+('<span class="waffle-assistant-answercard-answer-col">'+
U(p)+"</span>"):a+('<span class="'+W("waffle-assistant-answercard-answer-col waffle-assistant-answercard-answer-empty")+'">N/A</span>')}a+="</div>"}a+="</div>"}a+='<div class="waffle-assistant-answercard-formula-holder"><div class="waffle-assistant-answercard-see-formula-link">See formula</div><div class="waffle-assistant-answercard-hide-formula-link">Hide formula</div><div class="waffle-assistant-answercard-formula"><div class="waffle-assistant-answercard-formula-icon">'+U(Hu({icon:"docs-icon-img docs-icon-insert-formula"}))+
'</div><div class="waffle-assistant-answercard-formula-text-container"><div class="waffle-assistant-answercard-formula-text" tabindex="0">'+U(e)+"</div></div></div></div></div></div>";d=V(a);return b(c+d+"</div></div>")}
function s$b(a){a=a.iS;var b;b=""+('<div class="waffle-assistant-answercard-question-container"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+fs("Question")+'"><span aria-hidden="true">Question</span></div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">');for(var c=a.length,d=0;d<c;d++){var e=a[d];b+=e.className?'<span class="'+W(e.className)+'">'+U(e.text)+"</span>":U(e.text)}return V(b+"</div></div></div>")}
function t$b(){return V('<div class="waffle-assistant-answercard-feedback-container"><div class="waffle-assistant-answercard-feedback-link">Send feedback</div></div>')}function u$b(){return V(U(V('<div class="waffle-assistant-answers-card-remove">'+U(Hu({icon:"docs-icon-img docs-icon-trash"}))+"</div>")))};var v$b="help;how can;how do i;how do you;how do u;how to;what can;what does;what is this".split(";");function w$b(a,b,c,d){K.call(this,"sqc");this.F=a;this.C=d||"";this.Y=c}z(w$b,K);function vW(a,b,c,d,e,g,h,k){mW.call(this,new hW,k);this.J=a;this.Da=b;this.Ua=c;this.Na=d;this.Za=g;this.ea=e;this.La=h;this.Uc=Ro(new Qo,10).Ga();this.R=new dt("",new kW,this.oa);this.Ma(this.R);this.C=null;this.O=new dt("",new jW,this.oa);this.Ma(this.O);this.L=new dt("",new jW,this.oa);this.Ma(this.L)}z(vW,mW);q=vW.prototype;q.Zia=f("La");q.Sa=function(){vW.Z.Sa.call(this);K9b(this).appendChild(Gr(u$b))};
q.Fa=function(){vW.Z.Fa.call(this);var a=T(this,"waffle-assistant-answers-card-remove");this.R.Va(a);UV(a,"Remove card",0);Df(this.getHandler(),this.R,"action",this.DVb).V(this.O,"action",this.jxb).V(this.L,"action",this.Lob)};
q.Xy=function(a){nW(this).appendChild(Gr(r$b,{w3:l$b(this.J)}));this.O.Va(T(this,"waffle-assistant-answercard-see-formula-link"));this.L.Va(T(this,"waffle-assistant-answercard-hide-formula-link"));this.C=new uW(T(this,"waffle-assistant-answercard-formula-text-container"),this.Da,this.Ua,this.Na);var b=this.Id();this.C.J=b;this.C.O=[this.J.Kn];H(this,this.C);b=T(this,"waffle-assistant-answercard-formula-text");tp(b,"Formula: "+(this.J.Kn+". Click/Press ENTER to copy or drag to insert on to sheet."));
Ff(this.getHandler().V(this.C,"formula_inserted",this.CVb),T(this,"waffle-assistant-answercard-formula-text"),kd,this.cob);x$b(this,!1);a()};q.Qy=function(){tp(this.Ba,"Answer Card for question: "+this.J.C)};q.mT=If;q.Lx=n("assistantAnswersFeedback");q.dE=n(2628);q.cE=n(2627);q.m7=n("Was this answer correct?");q.Wja=n("Correct");q.Vja=n("Incorrect");q.m6=f("J");q.uG=function(a){vW.Z.uG.call(this,a);this.C&&(this.C.J=a)};
function x$b(a,b){a.O.setVisible(!b);a.L.setVisible(b);R(T(a,"waffle-assistant-answercard-formula"),b)}q.DVb=function(){var a=new SV;P(a,3,!0);var b=new ST;cj(b,4,a);a=new co;cj(a,46,b);this.ea.Pb(2753,new Po(10,a));this.dispatchEvent(new K("rc"))};q.jxb=function(){x$b(this,!0)};q.Lob=function(){x$b(this,!1)};q.CVb=function(){this.ea.Pb(2709,this.Uc)};
q.cob=function(){var a=this.oa.yb(),b=a.createElement("textarea");b.textContent=this.J.Kn;b.style.position="fixed";a.body.appendChild(b);b.select();var c=!1;try{c=a.execCommand("copy")}catch(d){}finally{a.body.removeChild(b)}c&&y$b(this.Za,"Formula copied to clipboard",this.oa)};function z$b(a,b,c){c=c||{};a=bs("Ask a question about your data");a='<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container">'+('<input class="waffle-assistant-answers-input-box" placeholder="'+W(a)+'" aria-label="'+W(a)+'"/></div><div class="waffle-assistant-answers-input-controls"><div class="waffle-assistant-answers-button-container">');a+='<div class="'+W("waffle-assistant-answers-query-box-button waffle-assistant-answers-clear-query-button")+
'">'+U(Hu({icon:"docs-icon-img docs-icon-cancel"}))+'</div></div><div class="waffle-assistant-answers-spinner-container" style="'+(c.bb?"/*"+c.bb+"*/":"")+'display:none"></div></div></form></div>';return V(a)};function A$b(a){var b=V,c='<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content">'+U(s$b({iS:a.xEa.iS})),d;d=a.xEa.error;var e=!!a.showHelp;a='<div class="waffle-assistant-answercard-error-container"><div class="waffle-assistant-answercard-error-image">'+U(Hu({icon:"docs-icon-img docs-icon-alert"}))+'</div><div class="waffle-assistant-errorcard-content">';e?(d=U(d)+' Look in <div class="waffle-assistant-answers-helpcenter-link">Sheets help</div> instead?',a+='<div class="waffle-assistant-errorcard-text">'+
d+"</div>"):a+='<div class="waffle-assistant-errorcard-text">'+U(d)+"</div>";d=V(a+"</div></div>");return b(c+d+"</div></div>")};function wW(a,b,c,d,e){mW.call(this,new hW,e);this.O=a;this.ea=b;this.L=d;this.Da=c;this.R=new dt("",new kW,this.oa);this.Ma(this.R);this.J=new dt("",new jW,this.oa);this.Ma(this.J);this.C=new dt("",new jW,this.oa);this.Ma(this.C)}z(wW,mW);q=wW.prototype;q.Qy=function(){tp(this.Ba,"Error Card for question: "+this.O.C)};q.Lx=n("assistantAnswersFeedback");q.mT=If;q.S8=Hf;q.Sa=function(){wW.Z.Sa.call(this);K9b(this).appendChild(Gr(u$b))};
q.Fa=function(){wW.Z.Fa.call(this);var a=T(this,"waffle-assistant-answers-card-remove");this.R.Va(a);this.C.setVisible(this.L);UV(a,"Remove card",0);Df(Df(this.getHandler(),this.R,"action",this.HVb),this.J,"action",this.wxb).V(this.C,"action",this.Hob)};
q.Xy=function(a){nW(this).appendChild(Gr(A$b,{xEa:n$b(this.O),showHelp:this.L}));var b=Gr(t$b);this.oa.appendChild(this.Ba,b);this.J.Va(T(this,"waffle-assistant-answercard-feedback-link"));this.L&&this.C.Va(T(this,"waffle-assistant-answers-helpcenter-link"));a()};q.Zia=f("ea");q.m6=f("O");q.wxb=function(){this.J.setVisible(!1);R(T(this,"waffle-assistant-answercard-feedback-container"),!1);this.dispatchEvent(new K("trigger_feedback"))};
q.HVb=function(){var a=new SV;P(a,3,!1);var b=new ST;cj(b,4,a);a=new co;cj(a,46,b);this.Da.Pb(2753,new Po(10,a));this.dispatchEvent(new K("rc"))};q.Hob=function(){Q.$n.Xb()};function B$b(a){mW.call(this,new hW,a);this.C=this.oa.createElement("div");hn(this.C,"Previous")}z(B$b,mW);q=B$b.prototype;q.Qy=function(){tp(this.Ba,"Previous questions below")};q.Sa=function(){B$b.Z.Sa.call(this);yp(this.Ba,"waffle-assistant-card");wp(this.Ba,"waffle-assistant-answers-previousheadercard")};q.Xy=function(a){0<this.oa.yh(nW(this)).length||nW(this).appendChild(this.C);a()};q.S8=Hf;q.Lx=n("assistantAnswersFeedback");function C$b(a){var b;b=""+(a.title?'<div class="waffle-assistant-suggestionscard-header">'+U(a.title)+"</div>":"");var c;c=bs("Suggested question");b+='<div class="waffle-assistant-suggested-questions">';a=a.ZOb;for(var d=a.length,e=0;e<d;e++){var g=a[e];b+='<div class="waffle-assistant-answercard-question-container" tabindex="0"><div class="waffle-assistant-answercard-question-header" role="heading" aria-label="'+W(c)+'">'+U(Hu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answercard-question-content"><div class="waffle-assistant-answercard-question">'+
U(g)+"</div></div></div>"}return V(b+"</div>")};function xW(a,b,c,d,e){mW.call(this,a,e);this.J=c;this.C=d;this.L=b}z(xW,mW);q=xW.prototype;q.dE=function(){return zb([D$b,E$b],this.C)?2799:zb([F$b,G$b],this.C)?2801:null};q.cE=function(){return zb([D$b,E$b],this.C)?2798:zb([F$b,G$b],this.C)?2800:null};q.m7=n("Were these interesting?");q.Wja=n("Interesting");q.Vja=n("Not interesting");q.Lx=n("assistantAnswersFeedback");q.Qy=function(){var a=this.C.title;a&&this.J?tp(this.Ba,a+(" for question : "+this.J)):tp(this.Ba,"Suggested questions")};
q.Xy=function(a){this.L.then(function(b){var c=this.oa,d=nW(this);if(0==c.yh(d).length){var e=Gr(C$b,{title:this.C.title,ZOb:tb(b,function(a){return a.query})});d.appendChild(e);d=rq(this,"waffle-assistant-answercard-question-container");A(d,function(a,d){var e=new dt("",new kW,c);this.Ma(e);e.Va(a);this.getHandler().V(e,"action",y(this.azb,this,b[d]))},this)}a()},null,this)};q.azb=function(a){this.dispatchEvent(new w$b(this.C.u0,0,a.Kn||null,a.query))};
var H$b={title:"",u0:null},D$b={title:"",u0:1},E$b={title:"Suggested questions",u0:1},G$b={title:"Did you mean?",u0:4},F$b={title:"Related questions",u0:4};function I$b(a,b){var c=[],d={};if(a>b*b)for(var e=0;e<b;e++){var g;do g=Math.floor(Math.random()*a);while(d[g]);d[g]=1;c.push(g)}else{for(e=0;e<a;e++)c.push(e);for(e=0;e<b;e++)d=Math.floor(Math.random()*(a-e)+e),g=c[e],c[e]=c[d],c[d]=g}return c.slice(0,b)}function yW(a){return I$b(a,1)[0]};function J$b(a){this.J=[];this.D={};this.L=a;this.C=new vP}function K$b(a,b,c,d){function e(a){return a.toLowerCase()}Pb(b,void 0,e);Pb(c,void 0,e);Pb(d,void 0,e);A(b,a.F,a);A(c,a.F,a);A(d,a.F,a)}J$b.prototype.F=function(a){for(var b=a.toLocaleLowerCase(),c=0,d=0;d<b.length&&3>c;++d)if(0==d||/[^a-zA-Z0-9]/.test(b[d-1])&&!/[^a-zA-Z0-9]/.test(b[d])){++c;var e=a,g=b.substr(d),h=this.C.get(g);h||(h=[],this.C.add(g,h));h.push(e)}};
J$b.prototype.KF=function(a,b,c){var d;if(Ua(a||"")){d=this.L.Nl();d=L$b(this,a.substring(0,d));var e=M$b(this,b-d.length,a);d=Jb(d,e)}else d=M$b(this,b);d.length>b&&(d=Mb(d,0,b));c(a,d)};function M$b(a,b,c){var d=c||"";c=ac(a.D,function(a){return Ka(a,d)});var e=N$b(fc(c),d?1:2,1);a=sb(a.J,function(a){return Ka(a.query,d)&&!e[a.query.toLowerCase()]});b=N$b(a,b-ec(e),2);return Jb(fc(b),fc(e))}
function L$b(a,b){for(var c=[],d=3,e={},g=b.toLowerCase(),h=0;h<g.length&&0<d;++h)if(0==h||" "==g[h-1]&&" "!=g[h]){var k={},l=0,m=g.substr(h),p=a.C.xe(m);A(p,function(a){var b=a.length-m.length;l=Math.max(b,l);a=this.C.get(a);k[b]||(k[b]=[]);Lb(k[b],a)},a);for(p=0;p<=l&&0<d;++p){var r=k[p];if(r)for(var t=0;t<r.length&&0<d;++t){var w=r[t];ab(b.toLowerCase(),w.toLowerCase())||e[w]||(--d,c.push({text:w,Kn:"",NB:0,yAa:g.length-h}),e[w]=!0)}}}return c}
function N$b(a,b,c){b=I$b(a.length,Math.min(a.length,b));var d={};A(b,function(b){b=a[b];var e=va(b)?b:b.query;d[e.toLowerCase()]={text:e,Kn:va(b)?"":b.Kn,NB:c,yAa:0}});return d};function zW(){oF.call(this,"",null,!1)}z(zW,oF);zW.prototype.sB=function(a,b){if(2==a.NB||1==a.NB)return zW.Z.sB.call(this,a.text,b);var c=this.Ia(),d=this.Nl(),e=" "==c[d];void 0==c[d]&&(c=c.trim(),d>c.length&&(d=c.length));var g=c.substring(0,d-a.yAa)+a.text;e||(g+=" ");a=zW.Z.sB.call(this,{toString:function(){return g+c.substring(d)}},b);this.T_(g.length);b=this.zj;b.blur();b.focus();return a};
zW.prototype.Hg=function(a){var b=zW.Z.Hg.call(this,a);b||39!=a.keyCode||a.ctrlKey||a.shiftKey||(b=this.C,uWa(b)&&b.nE()&&a.preventDefault(),b=!0);return b};function O$b(){return V('<div class="waffle-assistant-answers-ac-suggestion"><div class="waffle-assistant-answers-ac-suggestion-icon-container"><div class="waffle-assistant-answers-ac-suggested-query-icon">'+U(Hu({icon:"docs-icon-img docs-icon-help"}))+'</div><div class="waffle-assistant-answers-ac-session-query-icon">'+U(Hu({icon:"docs-icon-img docs-icon-clock"}))+'</div><div class="waffle-assistant-answers-ac-entity-icon">'+U(Hu({icon:"docs-icon-img docs-icon-arrow-tilted"}))+'</div></div><span class="waffle-assistant-answers-ac-suggestion-text"></span></div>')}
;function P$b(a){this.C=a||Em()}P$b.prototype.XK=function(a,b,c){b=Gr(O$b);var d=tn(this.C,"waffle-assistant-answers-ac-suggestion-text",b);a=a.data;this.C.Nf(d,a.text);var d=tn(this.C,"waffle-assistant-answers-ac-entity-icon",b),e=tn(this.C,"waffle-assistant-answers-ac-suggested-query-icon",b),g=tn(this.C,"waffle-assistant-answers-ac-session-query-icon",b);R(d,0==a.NB);R(e,2==a.NB);R(g,1==a.NB);this.C.appendChild(c,b)};function AW(a,b,c,d,e,g,h,k,l){VV.call(this,l);this.Je=c;this.$e=d;this.Di=e;this.Gf=a;this.qc=h;this.Da=this.O=this.F=this.eb=null;this.$=new zW;this.$.mFa=!0;this.$.ea=!0;this.La=new J$b(this.$);a=new mF(null,new P$b(l));this.R=new hF(this.La,a,this.$);H(this,this.R);this.J=g;this.ea=null;this.oh=k;this.Ya=!1;this.Uc=Ro(new Qo,10).Ga();this.Si=new Ii;this.Na={};this.X=this.C=this.mb=null;this.Rb=[];this.Gb=[];this.Ke=vJ.getInstance();this.Za=""}z(AW,VV);q=AW.prototype;
q.Sa=function(){AW.Z.Sa.call(this);var a=this.R.Re();a.className="waffle-assistant-answers-ac-renderer";a.Bi="waffle-assistant-answers-ac-row";a.jt="waffle-assistant-answers-ac-active";a.AH="waffle-assistant-answers-ac-highlighted"};q.Fa=function(){AW.Z.Fa.call(this);this.$.C=this.R;this.R.I3=!1;this.R.f$=6;this.getHandler().V(this.R,"update",this.Dhb);this.nL(null==this.ea)};
q.hqa=function(a,b){AW.Z.hqa.call(this,a,b);b=this.oa;var c=this.Y;b.appendChild(a,Gr(z$b));this.X=tn(b,"waffle-assistant-answers-query-box",a);this.F=new dt("",new kW,this.oa);c.Ma(this.F);this.F.Va(tn(b,"waffle-assistant-answers-clear-query-button",this.X));this.Da=new LV(!1,"#4285f4");c.Ma(this.Da);this.mb=tn(b,"waffle-assistant-answers-spinner-container",this.X);this.Da.render(this.mb);this.C=tn(b,"waffle-assistant-answers-input-box",this.X);JWa(this.$,this.C);UV(this.F.getElement(),"Clear query");
c.getHandler().V(this.X,"submit",y(this.Xyb,this)).V(this.X,"focus",y(this.sEa,this,!0),!0).V(this.X,"blur",y(this.sEa,this,!1),!0).V(this.F,"action",y(this.X2a,this)).V(this.C,"input",y(this.gQb,this)).V(this.C,"focus",y(this.MLb,this));this.F.setVisible(!1)};q.P4=function(){LWa(this.$,this.C);this.F.setVisible(!1);this.Da.dispose();this.Da=null;AW.Z.P4.call(this)};q.nL=function(a){AW.Z.nL.call(this,a);this.C&&(a?this.C.setAttribute("disabled",!0):this.C.removeAttribute("disabled"))};q.lh=ea("eb");
function Q$b(a,b,c){var d=tb(Cc(c,1),function(a){return a.getName()}),e=[],g=[];A(Cc(c,2),function(a){e.push(a.getName());g=g.concat(Cc(a,2))});K$b(a.La,d,e,g);R$b(a.Gf).then(function(a){this.La.J=a},null,a);a.ea=b;a.nL(null==b)}q.reset=function(){oU(this.Na);oU(this.La.D);this.O=null};
function S$b(a){if(a.rc()&&(T$b(a),null!=a.ea))for(var b=Xz(a.Je),c=b.ud(),c=tb(fc(Vg),c.d1,c),c=tb(c,Da(uh,a.ea.rect)),d=0;d<c.length;d++)if(c[d]&&Gh(c[d])){var e=OT(b,c[d],"waffle-assistant-answers-styled-rect");H(a,e);zF(kI(b),e,!0);e.setVisible(!0);a.Rb.push(e);e=RH(b,c[d],"waffle-assistant-answers-styled-border",1,0);H(a,e);e.setVisible(!0);a.Gb.push(e)}}function T$b(a){Hc(a.Rb);Hc(a.Gb);a.Rb=[];a.Gb=[]}
q.Dhb=function(a){a.row&&(a=a.row,2==a.NB?(U$b(this,1,a.Kn),this.J.Pb(2652,this.Uc)):0==a.NB?(this.Ya=!0,this.J.Pb(2651,this.Uc)):1==a.NB&&U$b(this,3))};q.sEa=function(a){Ap(this.X,"waffle-assistant-answers-query-box-focused",a)};q.gQb=function(){this.F.setVisible(!!V8b(this.C))};q.MLb=function(){var a=Qa(V8b(this.C));this.$.T_(a.length);rWa(this.R,a||"  ");this.R.update(!0)};
function U$b(a,b,c){var d=Ua(V8b(a.C));if(!a.eb||3<=a.eb.getStatus().getState().C)d=new tW(d,null,null,2),V$b(a,d,!1);else{if(d&&a.ea)if(a.Na[d])a.J.Pb(2681,a.Uc),c=a.Na[d],c!=pb(a.D)&&(1<a.D.length&&(W$b(a),X$b(a)),Y$b(a,c.m6()),f9b(a,c));else{var e=Z$b(),g=aj(aj(e,ST,46),SV,4);P(g,2,a.Ya);a.J.Pb(2635,new Po(10,e));a.Ya=!1;e=Gw(a.ea.rect);b=Vk(qj(rj(a.eb.Cf("/answers/parse").Ff("q",d,"qt",b,"gid",a.ea.xd,"range",e),y(a.Qj,a,d,b)),y(a.EVb,a,d,b)),"POST");c&&b.Ff("sgfml",c);b.Te();a.Za=wJ(a.Ke,ij.Yta);
$$b(a,!0)}else U8b(a.C,"");a.C.blur();a.F.setVisible(!!d);jF(a.R)&&a.R.Cj()}}q.Xyb=function(a){a.stopPropagation();a.preventDefault();U$b(this,2)};q.X2a=function(){U8b(this.C,"");this.F.setVisible(!1)};q.EVb=function(a){var b=Z$b(),c=aj(aj(b,ST,46),SV,4);P(c,1,X8b.wya);this.J.Pb(2640,new Po(10,b));aac(this,a)};function aac(a,b){$$b(a,!1);b=new tW(b,null,null,3);V$b(a,b,!1);bac(a)}
q.Qj=function(a,b,c){var d=null;b=null;var e=!1,g=Z$b(),h=aj(aj(g,ST,46),SV,4);P(h,1,X8b.wya);g=new Po(10,g);if(c.$k()){b=this.Si.td($V.Ca(),c.Mf());if(e=b.getStatus()){var k;switch(e){case 1:k=2639;break;case 2:k=2643;break;case 3:k=2644;break;case 4:k=2638;break;case 5:k=2707;break;case 6:k=2706}k&&this.J.Pb(k,g)}if(1==e){aac(this,a);return}if(2==e){b=-1!=cac(a);a=new tW(a,null,null,b?5:4);b?(b=new wW(a,!0,this.J,!0,this.oa),dac(this,a,b)):V$b(this,a,!0);$$b(this,!1);bac(this);return}k=b.hasFormula()?
D(b,2):null;c=xc(b,9)?b.getError().xl():null;e=!0;k?(d=jw(this.$e),d=null!=d?d.toString():"0",(d=R8b(this.oh,k,d))||this.J.Pb(2645,g),d=new tW(a,d,b,null)):c&&(d=new tW(a,null,b||null,6))}else this.J.Pb(2640,g);d||(d=new tW(a,null,b||null,4));$$b(this,!1);1==d.error&&null!=d.Kn?eac(this,d,e):V$b(this,d,e);bac(this)};function bac(a){""!=a.Za&&(xJ(a.Ke,a.Za),a.Za="")}
function fac(a){if(null!=a.Kn)return F$b;switch(a.error){case 4:return 0<a.D.length?G$b:E$b;case 5:return E$b;case 6:return G$b}return H$b}function Z$b(){var a=new SV,b=new ST;cj(b,4,a);a=new co;cj(a,46,b);return a}function cac(a){return yb(v$b,function(b){return Ka(a,b)})}function gac(a){var b=[];a=a.D;0<a.length&&(a=Mb(a,0,3),b=tb(a,function(a){return{query:D(a,1),Kn:D(a,2),type:a.getType()}}));return Bj(b)}function eac(a,b,c){c=new vW(b,a.Je,a.$e,a.Di,a.J,a.qc,c,a.oa);dac(a,b,c)}
function V$b(a,b,c){c=new wW(b,c,a.J,!1,a.oa);dac(a,b,c)}function dac(a,b,c){W$b(a);X$b(a);Y$b(a,b);hac(a,c);for(var d=a.D;5<d.length;)a.WK(d[0]);if(1==b.error&&null!=b.Kn){var d=a.La,e=b.C;d.D[e.toLowerCase()]||(d.D[e.toLowerCase()]=e)}c.Zia()&&(a.Na[b.C]=c);a.getHandler().V(c,"rc",a.Tvb)}function X$b(a){0!=a.D.length&&(a.O?f9b(a,a.O):(a.O=new B$b(a.oa),hac(a,a.O)))}function W$b(a){A(a.D,function(a){a instanceof vW||a instanceof wW||a==this.O||this.WK(a)},a)}
function Y$b(a,b){var c=fac(b),d=null;c==F$b||c==G$b?0<b.D.length&&(d=gac(b)):c==E$b&&(d=iac(a.Gf));d&&(c=new xW(new hW,d,b.C,c,a.oa),hac(a,c),a.J.Pb(2769,a.Uc),a.getHandler().V(c,"sqc",y(a.$yb,a,b)))}q.$yb=function(a,b){U8b(this.C,b.C);this.C.focus();U$b(this,b.F,b.Y);this.J.Pb(2762,this.Uc)};function $$b(a,b){R(a.mb,b);R(tn(a.oa,"waffle-assistant-answers-button-container",a.X),!b);a.Da&&a.Da.setActive(b)}function hac(a,b){b.uG(a.Id());a.D.push(b);a.Qc&&(a.L.ri(b,0,!0),b.jO());WV(b,!0)}
q.Z3=function(){AW.Z.Z3.call(this);this.reset()};q.Tvb=function(a){var b=this.oa;a=a.target;a instanceof vW?(this.WK(a),y$b(this.qc,"Answer removed",b,y(this.Uvb,this,a))):a instanceof wW&&(this.WK(a),y$b(this.qc,"Card removed",b));b=this.D;!this.O||b[0]!=this.O&&b[b.length-1]!=this.O||(this.WK(this.O),this.O=null)};q.Uvb=function(a){eac(this,a.m6(),a.Zia())};q.WK=function(a){if(a.rc()){if(a instanceof vW||a instanceof wW)delete this.Na[a.m6().C],a==pb(this.D)&&W$b(this);AW.Z.WK.call(this,a)}J(a)};function jac(){var a;a=""+(V('<div class="waffle-assistant-answers-logging-message-container"><div class="waffle-assistant-answers-logging-message"><span class="waffle-assistant-answers-logging-text">We\'re logging your queries and data to improve the feature.</span><div class="waffle-assistant-answers-learn-more">Learn More</div><div class="waffle-assistant-answers-logging-opt-out">Opt-out for this file</div></div></div>')+'<div class="waffle-assistant-answers-input"><form class="waffle-assistant-answers-query-box"><div class="waffle-assistant-answers-input-container"><div class="waffle-assistant-answers-search-icon">'+
U(Hu({icon:"docs-icon-img docs-icon-search-this-document"}))+'</div><input class="waffle-assistant-answers-input-box" placeholder="'+fs("Ask a question about your data")+'" /></div></form></div>');return V(a)};function kac(a){this.C=a;for(var b=new gg,c=0;c<yc(a,2);c++)b.set(a.$d(c).getName().toLowerCase(),c);this.$=b;b=new gg;for(c=0;c<yc(a,1);c++)b.set(D(a,1,c).getName().toLowerCase(),c);this.va=b;b=[];for(c=0;c<yc(a,2);c++)BW(a.$d(c).getName())&&b.push(c);this.D=b;b=[];for(c=0;c<yc(a,1);c++)BW(D(a,1,c).getName())&&b.push(c);this.F=b;b=[];for(c=0;c<yc(a,1);c++){for(var d=D(a,1,c).getName(),e=!0,g=0;g<lac.length;g++)if(-1!=d.search(new RegExp("(\\b|_)"+lac[g]+"(\\b|_)","i"))){e=!1;break}e&&b.push(c)}this.Y=
b;this.X=mac(a,0);this.R=mac(a,1);b=[];for(c=0;c<yc(a,2);c++).8<=D(a.$d(c),6)&&b.push(c);this.O=b;this.J=[];this.L=[]}function mac(a,b){for(var c=[],d=0;d<yc(a,2);d++)a.$d(d).getType()==b&&c.push(d);return c}function nac(a,b,c){return b||c?(b=b?a.X:null,c&&(b=null==b?a.O:oac(b,a.O)),b=CW(b,a.D),b=CW(b,a.J),0<b.length?b[yW(b.length)]:-1):0<a.D.length?(b=CW(a.D,a.J),b[yW(b.length)]):yW(yc(a.C,2))}
function DW(a,b){return b?(b=CW(a.Y,a.F),b=CW(b,a.L),0<b.length?b[yW(b.length)]:-1):0<a.F.length?(b=CW(a.F,a.L),b[yW(b.length)]):yW(yc(a.C,1))}function pac(a){var b=Cc(a.C,3),b=oac(b,a.X),b=oac(b,a.O),b=CW(b,a.D),b=CW(b,a.J);return 0<b.length?b[yW(b.length)]:-1}function qac(a,b){for(var c=5;;){var d=a.C.$d(b),e=yW(yc(d,2));c--;if(BW(D(d,2,e))||0==c)return e}}function EW(a,b){b=a.C.$d(b);a=b.getName();BW(a)||(b=rac(Cc(b,7)),a=null==b?a:b);return a}
function FW(a,b){b=D(a.C,1,b);a=b.getName();BW(a)||(b=rac(Cc(b,2)),a=null==b?a:b);return a}function rac(a){for(var b=0;b<a.length;b++)if(BW(a[b]))return a[b];return null}function BW(a){return null==a?!1:50>=a.length}function sac(a,b){return a.$.get(b.toLowerCase(),-1)}function tac(a,b){return a.va.get(b.toLowerCase(),-1)}function uac(a){for(var b=I$b(a.length,2),c=[],d=0;d<b.length;d++)c.push(a[b[d]]);return c}
function oac(a,b){for(var c=[],d=0,e=0;d<a.length&&e<b.length;)a[d]==b[e]?(c.push(a[d]),d++,e++):a[d]<b[e]?d++:e++;return c}function CW(a,b){b=oac(a,b);return 0<b.length?b:a}var lac=["average","total","sum","mean","median"];function vac(a,b){this.C=[];this.D=[];this.J=this.R=this.F=null;this.O=new og;this.L=new og;this.Y=b;this.X=a}vac.prototype.reset=function(){this.C=[];this.D=[];this.F&&(this.F.cancel(),this.F=null);this.L=new og;this.O=new og};vac.prototype.lh=ea("J");function R$b(a,b){if(roa)return a.F.then(function(){var a=this.D.slice();b||$8b(a);return a},null,a);a=a.C.slice();b||$8b(a);return Bj(a)}
function wac(a){if(!a.C)throw Error("Suggestions not generated. Must call generate() at the top level");return 0<a.C.length?a.C[0].query:""}function GW(a,b,c,d){a.L.contains(c)||(b.push({query:c,Kn:void 0,type:d}),a.O.add(d),a.L.add(c))}function HW(a,b){return!a.O.contains(b)}function iac(a){return R$b(a,soa).then(function(a){return 3>=a.length?a:Mb(a,0,3)},null,a)}function xac(a,b){for(var c=[],d=0;d<yc(b,1);d++){var e=D(b,1,d);if(xc(e,2)){var g=D(e,2);if(-1==tac(a,g))break;c.push(e)}}return c}
function yac(a,b){for(var c=[],d=0;d<yc(b,1);d++){var e=D(b,1,d);if(xc(e,2)){var g=D(e,2);if(-1==sac(a,g))break;c.push(e)}}return c}function zac(a){switch(a){case 6:return"Sum";case 1:return"Average";case 4:return"Count"}return null}function IW(a){return a[yW(a.length)]}
function Aac(a){a.F=new zj(function(a){if(!this.J||3<=this.J.getStatus().getState().C)this.D=this.C,a();var b=Gw(this.R.rect),d=tb(this.C,function(a){return a.query});Vk(mma(oj(qj(rj(this.J.Cf("/answers/parsesuggestions").Ff("gid",this.R.xd,"range",b),y(function(b){var c=[];if(b.$k()){b=b.Mf();for(var d=0;d<b.length;d++){var e;if(e=b[d])a:{e=b[d];var l=jw(this.Y),l=null!=l?l.toString():"0";if(e=R8b(this.X,e,l))for(l=1<e.length?1:0;l<e.length;l++){for(var m=!1,p=e[l],r=0;r<p.length;r++)if(!p[r]){m=
!0;break}if(!m){e=!0;break a}}e=!1}e&&(this.C[d].Kn=b[d],c.push(this.C[d]))}}this.D=c;a()},this)),y(function(){this.D=this.C;a()},this)).setContent(["queries",Ui(d)]).setTimeout(2E3),1)),"POST").Te()},a)}var Bac="Minimum Maximum Most Least Highest Lowest".split(" "),Cac=["Average","Total","Sum"],Dac=["before","after"];function JW(a,b,c,d,e,g,h){XV.call(this,1,g,e,h);this.Za=c;this.ea=null;this.Y=new dt("",new jW,this.oa);this.Ma(this.Y);this.$=new dt("",new jW,this.oa);this.Ma(this.$);a=new Ikb(a,!0,!0);this.L=new vac(a,c);this.C=new AW(this.L,0,b,c,d,e,this.Ya,a,h);this.F=this.Da=null;this.Uc=Ro(new Qo,10).Ga()}z(JW,XV);
var Eac={AYa:"waffle-assistant-answers-input-box",NZa:"waffle-assistant-answers-query-box",jic:"waffle-assistant-answers-query-box-focused",KYa:"waffle-assistant-answers-learn-more",qec:"waffle-assistant-answers-logging-message-container",qZa:"waffle-assistant-answers-logging-opt-out"};q=JW.prototype;q.Sa=function(){JW.Z.Sa.call(this);var a=Gr(jac);this.oa.appendChild(h9b(this),a)};
q.Fa=function(){JW.Z.Fa.call(this);var a=T(this,Eac.NZa),b=T(this,Eac.AYa);this.$.Va(T(this,Eac.qZa));this.Y.Va(T(this,Eac.KYa));this.getHandler().V(a,"focus",this.fvb,!0).V(a,"blur",this.dvb,!0).V(a,"mouseover",this.hvb).V(a,"mouseout",this.gvb).V(a,"click",this.evb).V(b,"input",this.FVb).V(this.$,"action",this.Dtb).V(this.Y,"action",this.tqb).V(nw(this.Za),"Ib",Z8b(this.GVb,25,this));this.setVisible(null!=this.Da);Fac(this,noa&&pm("showAnswersLoggingOptOut"))};q.wSa=Hf;q.kLa=If;q.vra=Hf;q.f1=n("Answers");
q.Aca=n(1);q.Q3=function(a){return 3==a||0==a};q.zta=function(a,b){Sb(a,function(a,b){return b.getConfidence()-a.getConfidence()});for(var c=[],d=null,e=0;e<a.length;e++){var g=Dc(a[e],1);3==g?d=a[e]:0==g&&c.push(a[e].getAutovisRecommendation())}d&&d.getConfidence()?(e=b||null,0<yc(d,4)?Gac(this,LT(d.lJ()),D(d,9),c):Gac(this,e,D(d,9),c),this.F||(JW.Z.zta.call(this,a,b),this.getHandler().V(this.F,"sqc",this.Zyb))):this.e1(!0)};
q.gW=function(a){if(!this.F){var b=iac(this.L);this.F=new xW(a,b,"",D$b,this.oa)}return this.F};q.vBa=f("C");q.Bma=function(){return this.Ta()};
q.e1=function(a,b,c){this.L.reset();(a||b)&&this.F&&(JW.Z.e1.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||u(b)&&!b)this.F&&(JW.Z.e1.call(this,a,b,c),this.F.dispose(),this.F=null),this.rc()&&(this.L.reset(),this.Da=null,a=this.C,a.rc()&&(b=a.La,b.J=[],b.C.clear(),a.C&&U8b(a.C),a.Z3(),a.ea=null,a.nL(!0),a.F&&!a.F.isDisposed()&&a.F.setVisible(!1),a.Ya=!1),this.setVisible(!1),this.Ob()&&T$b(this.C));c&&this.C.reset()};q.lh=function(a){this.ea=a;this.C.lh(a);this.L.lh(a)};
q.setActive=function(a){JW.Z.setActive.call(this,a);a?S$b(this.C):T$b(this.C)};function Fac(a,b){R(T(a,"waffle-assistant-answers-logging-message-container"),b)}function Hac(a,b){a=T(a,"waffle-assistant-answers-query-box");Ap(a,"waffle-assistant-answers-query-box-focused",b)}q.GVb=function(){this.Ob()&&S$b(this.C)};q.fvb=function(){Hac(this,!0);S$b(this.C)};q.dvb=function(){Hac(this,!1);this.Ob()||T$b(this.C)};q.hvb=function(){S$b(this.C)};q.gvb=function(){this.Ob()||T$b(this.C)};
q.evb=function(){Iac(this,"")};q.FVb=function(){var a=T(this,"waffle-assistant-answers-input-box");Iac(this,a.value);a.value=""};q.Zyb=function(a){Iac(this,a.C);Zk(function(){U$b(this.C,1)},150,this);this.O.Pb(2652,this.Uc)};function Iac(a,b){a.setActive(!0);a.dispatchEvent("assistant-sidepane-set-active-panel");Zk(function(){var a=this.C;U8b(a.C,b);a.C.focus()},150,a)}
function Gac(a,b,c,d){c=c||new eW;a.Da=b;var e=a.L;e.reset();var g=[],h=new kac(c);if(soa){for(var k=new og,l=new og,m=0;m<d.length;m++){var p=d[m];if(xc(p,6)){var r=D(p,6),t=sac(h,r);-1!=t&&k.add(t);r=tac(h,r);-1!=r&&l.add(r)}if(xc(p,25)){r=D(p,25);p=yac(h,r);r=xac(h,r);for(t=0;t<p.length;t++)k.add(sac(h,D(p[t],2)));for(t=0;t<r.length;t++)l.add(tac(h,D(r[t],2)))}}k=k.Fd();l=l.Fd();Sb(k);Sb(l);h.J=k;h.L=l;for(l=0;l<d.length;l++)switch(m=d[l],m.getChartType()){case "BarChart":k=e;r=h;t=m;m=g;if((HW(k,
12)||HW(k,1))&&(p=D(t,6))&&-1!=sac(r,p)){r=xac(r,D(t,25));if(0<r.length){var t=IW(r),w=zac(D(t,4));w&&HW(k,12)&&GW(k,m,w+" of "+D(t,2)+" by "+p,12)}1<r.length&&HW(k,1)&&GW(k,m,"Correlation between "+D(r[0],2)+" and "+D(r[1],2),1)}break;case "ScatterChart":k=e;p=h;r=m;m=g;HW(k,1)&&(p=xac(p,D(r,25)),1<p.length&&GW(k,m,"Correlation between "+D(p[0],2)+" and "+D(p[1],2),1));break;case "PieChart":k=e,p=h,r=m,m=g,HW(k,13)&&(p=yac(p,D(r,25)),1==p.length&&4==D(p[0],4)&&GW(k,m,"Distribution of "+D(p[0],2),
13))}}HW(e,0)&&(l=h.C,d=nac(h,!0,!0),0<yc(l,1)&&-1!=d&&(l=DW(h),d=EW(h,d),l=FW(h,l),d!=l&&GW(e,g,"Top "+d+" by "+l,0)));HW(e,1)&&1<yc(h.C,1)&&(2<=h.F.length?(d=CW(h.F,h.L),l=uac(2<=d.length?d:h.F)):l=I$b(yc(h.C,1),2),d=FW(h,l[0]),l=FW(h,l[1]),d!=l&&GW(e,g,"Correlation between "+d+" and "+l,1));HW(e,2)&&(d=DW(h,!0),-1!=d&&GW(e,g,IW(Cac)+" of "+FW(h,d),2));if(HW(e,4)&&(k=h.C,d=DW(h,!0),0<yc(k,3)&&-1!=d&&(d=FW(h,d),l=pac(h),-1!=l&&(k=k.$d(l),m=EW(h,l),0<yc(k,3)&&m!=d)))){a:for(p=5;;)if(r=h.C.$d(l),t=
yW(yc(r,3)),w=D(r,3,t),p--,BW(D(r,2,t))||0==p){l=w;break a}GW(e,g,IW(Cac)+" of "+d+" when "+m+" is "+D(k,2,l),4)}HW(e,8)&&(l=h.C,d=nac(h,!0,!0),0<yc(l,1)&&-1!=d&&(l=FW(h,DW(h)),d=EW(h,d),d!=l&&GW(e,g,d+" with "+IW(Bac)+" "+l,8)));HW(e,9)&&0<yc(h.C,1)&&(d=FW(h,DW(h)),GW(e,g,IW(Bac)+" "+d,9));HW(e,10)&&(d=h.C,0<yc(d,3)&&(l=pac(h),-1!=l&&(k=EW(h,l),0<yc(d.$d(l),3)&&GW(e,g,"Most frequent "+k,10))));if(HW(e,11)){d=h.C;k=DW(h,!0);a:{if(1==h.R.length&&(l=h.R[0],!D(h.C.$d(l),5)))break a;l=-1}-1!=l&&-1!=k&&
(k=FW(h,k),d=d.$d(l),0<yc(d,2)&&(l=qac(h,l),GW(e,g,IW(Cac)+" of "+k+" "+IW(Dac)+" "+D(d,2,l),11)))}((d=3>g.length)||0==yW(5))&&HW(e,6)&&(k=h.C,0<yc(k,1)&&0<yc(k,2)&&(p=DW(h),l=nac(h),k=k.$d(l),m=EW(h,l),p=FW(h,p),0<yc(k,2)&&m!=p&&(l=qac(h,l),GW(e,g,"Show "+p+" for "+m+" "+D(k,2,l),6))));(d||0==yW(5))&&HW(e,7)&&(k=h.C,d=nac(h,!0,!0),1<yc(k,2)&&-1!=d&&(2<=h.D.length?(l=CW(h.D,h.J),l=uac(2<=l.length?l:h.D)):l=I$b(yc(h.C,2),2),l=l[0]==d?l[1]:l[0],k=k.$d(l),m=EW(h,l),d=EW(h,d),0<yc(k,2)&&m!=d&&(h=qac(h,
l),GW(e,g,"What is "+d+" where "+m+" is "+D(k,2,h),7))));e.C=g;e.R=b;roa&&Aac(e);a.setVisible(null!=b);Q$b(a.C,b,c);a.Ob()&&S$b(a.C)}q.Dtb=function(a){a.stopPropagation();a.preventDefault();this.ea&&(Vk(qj(rj(this.ea.Cf("/answers/logoptout"),y(this.brb,this)),y(this.arb,this)),"POST").Te(),this.O.Pb(2663,this.Uc))};q.tqb=function(a){a.stopPropagation();a.preventDefault();To("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};
q.brb=function(a){a.$k()&&Fac(this,!1)};q.arb=da();function Jac(){var a;a=""+('<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+Kac()+"</div>");return V(a)}
function Lac(){return V('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+Kac()+"</div>")}function Kac(){var a;a=""+U(jt({Oe:"waffle-assistant-formatting-edit-button",content:bs("Edit"),style:4}));return V(a)};function KW(a,b,c){mW.call(this,a,c);a=tb(this.D.pfa(),r5b);this.C=new BU(!1,a,7);this.Ma(this.C);this.O=new kt("",this.oa);this.Ma(this.O);this.R=b;this.L=!1;this.J=-1}z(KW,mW);var Mac={Tca:"waffle-assistant-banding-color-picker-container",dda:"waffle-assistant-formatting-edit-button",jH:"waffle-assistant-banding-range"};q=KW.prototype;q.Sa=function(){KW.Z.Sa.call(this);nW(this).appendChild(Gr(Jac))};
q.Fa=function(){KW.Z.Fa.call(this);this.getHandler().V(this.O,"action",this.Cmb).V(this.C,"banding-scheme-changed",this.Shb);this.R.Pb(2768,void 0)};q.Xy=function(a){var b=T(this,Mac.Tca);this.C.render(b);x5b(this.C);var b=T(this,Mac.jH),c=this.D.lJ(),d=Oh(c);hn(b,Gw(d));Nac(this,c);b=T(this,Mac.dda);this.O.Va(b);a()};q.Qy=function(){tp(this.Ba,"Suggested alternating background colors");RT(this.C,"Choose a color scheme")};q.Lx=n("assistantBandingFeedback");q.dE=n(2672);q.cE=n(2671);
q.Cmb=function(a){On.dispatchEvent({type:"show-banding-pane-recommendation",xQa:this.D,T3a:y5b(this.C)});a.stopPropagation()};q.Shb=function(a){if(!this.L&&CU(this.C)){var b=this.J;this.J=this.C.Wh();this.J==b?this.dispatchEvent(new TV("assistant-sidepane-remove-banding",this,2797)):this.dispatchEvent(new TV("assistant-sidepane-apply-banding",this,2673));a.stopPropagation()}};
function Nac(a,b){a.L=!0;var c;c=b.fb();b=Oh(b);c=ritz.getWorkbookRangeIntersectingIds(c,b.hc(),b.bc(),b.Wc(),b.fd(),7,!1);c.length?(c=ritz.getBandedRangeByWorkbookRangeId(c[0]),c=(new Ii).td(Cd.Ca(),c),c=r5b(c)):c=null;c?(c=z5b(a.C,c),hL(a.C,c?c.getElement():null)):hL(a.C,null);a.J=a.C.Wh();a.L=!1};function LW(a,b){mW.call(this,a,b);this.C=new kt("",this.oa);this.Ma(this.C);this.mb=Cc(a,6)}z(LW,mW);var MW={dda:"waffle-assistant-formatting-edit-button",dYa:"waffle-assistant-conditionalformat-format-preview",i_a:"waffle-assistant-conditionalformat-rule-holder",E1:"waffle-assistant-conditionalformat-description",nZa:"one-rule",f0a:"two-rules",V_a:"three-rules",GZa:"waffle-assistant-conditionalformat-format-preview-label"};q=LW.prototype;q.Sa=function(){LW.Z.Sa.call(this);nW(this).appendChild(Gr(Lac))};
q.Fa=function(){LW.Z.Fa.call(this);var a=T(this,MW.dda);this.C.Va(a);UV(a,"Apply and edit conditional format rules");this.getHandler().V(this.C,"action",this.shb)};q.Xy=function(a){hn(T(this,MW.E1),Dc(this.D,3));var b=T(this,MW.i_a),c=new Oac(this,this.oa);this.Ma(c);c.Va(b);UV(b,"Apply conditional format rules");a()};q.Qy=ma;q.Lx=n("assistantConditionalFormatFeedback");q.dE=n(2630);q.cE=n(2629);
q.shb=function(){Pac(this);this.dispatchEvent(new TV("assistant-sidepane-change-selection",this,2670,void 0,void 0,Oh(D(this.mb[0],1,0))));Sn()};function Pac(a){a.dispatchEvent(new TV("assistant-sidepane-apply-conditional-format-rules",a,2563))}function Oac(a,b){dr.call(this,void 0,void 0,b);this.C=a}z(Oac,dr);
Oac.prototype.Fe=function(a){Oac.Z.Fe.call(this,a);var b=this.C.mb,c;switch(b.length){case 0:break;case 1:c=MW.nZa;break;case 2:case 4:c=MW.f0a;break;default:c=MW.V_a}for(var d=0;d<b.length;d++){var e=b[d],g=Pm("DIV");xp(g,[MW.dYa,c]);var h=Pm("DIV");wp(h,MW.GZa);g.appendChild(h);hn(h,"123");if(xc(e,2)){var k=D(D(e,2),1);switch(D(D(k,1),1)){case 9:case 13:var k=Cc(D(k,1),2)[0],l=Cc(e,1)[0];hn(h,gF(k,Dc(l,1),Dc(l,2),Dc(l,4)))}}K4b(e,g);a.appendChild(g)}};Oac.prototype.gj=function(){Pac(this.C);return!0};function Qac(a,b,c){XV.call(this,2,b,a,c)}z(Qac,XV);q=Qac.prototype;q.f1=n("Formatting");q.Q3=function(a){return 2==a||4==a};q.gW=function(a){var b=D(a,1);switch(b){case 2:return new LW(a,this.oa);case 4:return a=new KW(a,this.O,this.oa),this.getHandler().V(a,"assistant-sidepane-apply-banding",this.NNb).V(a,"assistant-sidepane-remove-banding",this.NBb),a;default:throw Error("Unsupported recommendation type: "+b);}};
q.NNb=function(a){y$b(this.Ya,"Alternating colors applied",this.oa,y(this.Thb,this,a.C))};q.NBb=function(){this.Ya.clear()};q.Thb=function(a){this.dispatchEvent(new TV("assistant-undo-pressed",a,2796))};q.g1=function(a){Qac.Z.g1.call(this,a);this.setVisible(!a)};q.Ata=function(a){return this.Id()?(this.setVisible(!1),a):Qac.Z.Ata.call(this,a)};q.Aca=n(3);function NW(a,b,c,d){Nu.call(this,a,b,c,d,void 0,void 0,!0)}z(NW,Nu);NW.prototype.Sa=function(){NW.Z.Sa.call(this);wp(this.Ba,"waffle-assistant-toast");wp(T(this,"docs-ui-toast-content"),"waffle-assistant-toast-content")};NW.prototype.JH=function(a,b,c){c=c?c:"waffle-assistant-toast-action";b=uq(this,b);NW.Z.JH.call(this,a,b,c)};NW.prototype.Gl=function(a,b,c,d){this.JH(a,b,d);a=wq(this,b);Ff(this.getHandler(),a,kd,y(function(){this.setVisible(!1);c()},this))};function Rac(){this.C=null}z(Rac,G);Rac.prototype.clear=function(){this.C&&(this.C.setVisible(!1),this.C.dispose(),this.C=null)};function y$b(a,b,c,d){a.clear();a.C=new NW(b,c,!1,5E3);a.C.render();d&&a.C.Gl("Undo","w-a-u-tm-u",d,void 0);a.C.setVisible(!0);a.C.getElement().focus()}Rac.prototype.ma=function(){Rac.Z.ma.call(this);this.clear()};function Sac(a){a=""+('<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+W(a.title)+'">'+U(a.name)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="'+fs("Press enter to insert formula")+'"></span></div>');return V(a)};function OW(a,b){pq.call(this);this.C=a;this.D=b}z(OW,pq);q=OW.prototype;q.Sa=function(){this.Ba=Gr(Sac,{name:this.C,title:this.D})};q.Fa=function(){OW.Z.Fa.call(this);var a=T(this,"waffle-assistant-quicksum-entry-name");UV(a);this.getHandler().V(this.Ba,"keypress",this.mVb);R(this.Ba,!1)};q.getFunctionName=f("C");q.Wa=function(a){hn(T(this,"waffle-assistant-quicksum-entry-value"),a||"");R(this.Ba,!!a)};q.Ta=function(){return Zp(this.Ba)};
q.mVb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new K("insert",this)))};function PW(a,b,c,d,e){pq.call(this,e);this.La=a;this.ea=b;this.R=c;this.L=d;this.D=a.C;this.Da=new Ii;this.Y=Ro(new Qo,17).Ga();this.X=Ro(new Qo,2).Ga();this.O=!1;this.F=[];this.C=null;this.J=[]}z(PW,pq);
PW.prototype.Fa=function(){PW.Z.Fa.call(this);this.ri(new OW(ritz.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.ri(new OW(ritz.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.ri(new OW(ritz.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.ri(new OW(ritz.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.ri(new OW(ritz.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=new uW(this.Ba,this.ea,this.D,this.R);this.C.J=this.O;H(this,this.C);this.getHandler().V(this,"insert",
this.$).V(this.C,"formula_inserted",this.Na)};
function Tac(a){function b(a){return l?ritz.renderNumberAsFormattedString(a,m):null}if(ow(a.D)){var c=pw(a.D),d=tC(c),e=TI(a.D);if(wb(d,c.Lt,c)){var g=[];a.F=[];for(c=0;c<d.length;c++){var h=d[c],k=iha(e+"",h.hc(),h.bc(),h.Wc(),h.fd());g.push(a.Da.serialize(k));a.F.push(h)}if(d=ritz.quickSum(g)){R(a.Ba,!0);var e=d.count,c=d.countNumberFormat,l=1<d.numericCount,m=l?d.valueNumberFormat:null;a.Ad(0).Wa(b(d.sum));a.Ad(1).Wa(b(d.average));a.Ad(2).Wa(b(d.min));a.Ad(3).Wa(b(d.max));1<e?a.Ad(4).Wa(ritz.renderNumberAsFormattedString(e,
c)):R(a.Ba,!1);if(a.C){a.C.O=[];a.J=[];for(c=0;c<a.od();++c)d=a.Ad(c),a.J.push(Uac(a,d.getFunctionName()));a.C.O=a.J}}else R(a.Ba,!1)}else R(a.Ba,!1)}else R(a.Ba,!1)}PW.prototype.$=function(a){var b=a.target;a=this.F[0];a=new N(a.left,a.Wc());b=b.getFunctionName();b=Uac(this,b);a=new KE(pw(this.D),a,b);this.R.C(a);this.L.Pb(2624,this.X)};PW.prototype.Na=function(){this.L.Pb(2624,this.Y)};function Uac(a,b){var c=Nw(a.La.Y);a=tb(a.F,function(a){return Gw(a)});return"="+b+"("+a.join(c)+")"};function Vac(a){a=""+('<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+U(jt({content:bs("INSERT CHART"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"}))+U(jt({Oe:"waffle-autovis-lightbox-close",content:cs(""+U(Hu({icon:"docs-icon-img docs-icon-close-white"}))),style:4,title:bs("Close")}))+'</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">\x3c!-- TODO(cuiffo): Replace with real icons --\x3e'+
U(jt({content:cs("&#10094;"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:ds('aria-label="'+fs("Previous chart")+'"')}))+'<div class="goog-inline-block waffle-autovis-lightbox-container"></div>'+U(jt({content:cs("&#10095;"),style:4,Oe:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:ds('aria-label="'+fs("Next chart")+'"')}))+'</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
U(a.zFb)+"</div></div></div>");return V(a)}function Wac(){return V('<div class="waffle-autovis-lightbox-chart"></div>')};function QW(a,b,c){pq.call(this,c);this.F=a;this.D=b;this.J=[];this.C=new kt("",this.oa);this.Ma(this.C);this.R=new kt("",this.oa);this.Ma(this.R);this.O=new kt("",this.oa);this.Ma(this.O);this.L=new kt("",this.oa);this.Ma(this.L)}z(QW,pq);q=QW.prototype;q.Sa=function(){QW.Z.Sa.call(this);this.Ba=Gr(Vac,{zFb:this.F.length})};
q.Fa=function(){QW.Z.Fa.call(this);var a=X.HG.isEnabled();Xac(this,!a);a=T(this,"waffle-autovis-lightbox-close");this.C.Va(a);a=T(this,"waffle-autovis-lightbox-insert");this.R.Va(a);var b=T(this,"waffle-autovis-lightbox-previous");this.O.Va(b);b=T(this,"waffle-autovis-lightbox-next");this.L.Va(b);Yac(this);Zac(this,this.D,!1);this.getHandler().V(document.body,ad,this.DQb).V(this.Ba,"keydown",this.EQb).V(Om(),"resize",this.HQb).V(this.C,"action",this.close).V(this.R,"action",this.Hpb).V(this.O,"action",
this.GQb).V(this.L,"action",this.FQb);b=new sv(this.Ba,this.oa);tv(b);H(this,b);a.focus()};function Yac(a){var b=T(a,"waffle-autovis-lightbox-content"),c=T(a,"waffle-autovis-lightbox-content-inner");a=T(a,"waffle-autovis-lightbox-page-count");var d=Mm();a=Vp(a);var e=d.height-a.height-195,g=d.width-200;.75<e/g?(d=g,e=.75*g):d=e/.75;Sp(c,d,e);Sp(b,d,e+a.height+35)}function Xac(a,b){Ap(a.Ba,"waffle-autovis-lightbox-readonly",b)}
function Zac(a,b,c){c&&Rn("Page "+(b+1+(" of "+(a.F.length+"."))));a.J[b]?$ac(a,b):a.F[b]&&$9b(a.F[b],y(a.fjb,a,b),!0)}q.fjb=function(a,b){if(!this.isDisposed()&&b){var c=T(this,"waffle-autovis-lightbox-container"),d=Gr(Wac);c.appendChild(d);this.J[a]=d;IV(b,d,mm);$ac(this,a)}};function $ac(a,b){R(a.J[a.D],!1);R(a.J[b],!0);a.O.Qa(0!=b);a.L.Qa(b!=a.F.length-1);var c=T(a,"waffle-autovis-lightbox-page-number");hn(c,b+1);a.D=b}q.DQb=function(a){!en(this.Ba,a.target)&&a.relatedTarget&&a.relatedTarget.focus()};
q.EQb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&Zac(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||abc(this);a.stopPropagation()};q.HQb=function(){var a=T(this,"waffle-autovis-lightbox-container");Vm(a);this.J=[];Yac(this);Zac(this,this.D,!0)};q.Hpb=function(){this.close();c$b(this.F[this.D],2256)};q.GQb=function(){0!=this.D&&Zac(this,this.D-1,!0);0==this.D&&this.L.Ba.focus()};q.FQb=function(){abc(this);this.D==this.F.length-1&&this.O.Ba.focus()};
function abc(a){a.D!=a.F.length-1&&Zac(a,a.D+1,!0)}q.close=function(){this.dispose()};q.vd=function(){QW.Z.vd.call(this);var a=this.F[this.D];a&&a.Ba&&a.Ba.focus()};function bbc(a){L.call(this);this.jc=a;this.J=a.C;this.Pa=new Ii;this.Ha=Pj();this.L=Pj();this.Ua=this.C=this.F=this.D=this.O=this.$=null;this.Na=!1;this.Y=null;this.wb=!0;this.Ka=this.Da=!1;this.La=this.$a=null;this.R=vJ.getInstance();this.ea=this.va="";this.X=new iW;F(this.X,2,Wna);a=Aoa&&!a.Id();F(this.X,3,a);F(this.X,4,toa);F(this.X,5,lm);F(this.X,6,woa);F(this.X,7,Boa);F(this.X,10,!1)}z(bbc,L);var cbc={Q_b:"cu",pWa:"cs",oWa:"ce",RYa:"ls",QYa:"le"};q=bbc.prototype;
q.update=function(a,b,c){c&&this.C&&!xb(c,function(a){return cha(a,this.C.rect)},this)||(this.Ha.cancel(!0),a&&(this.Ka=!0,this.L.cancel(!0),this.F=this.D=this.O=this.$=null),this.Ha=dbc(),this.Ha.addCallback(this.g2a,this),this.Ha.addCallback(Da(this.h2a,b),this))};q.lh=ea("$a");function dbc(){var a=null,b=new Ij(function(){null===a||$k(a)}),a=Zk(function(){b.Lb()});return b}q.qib=function(){this.Da=!0};
q.g2a=function(){var a=this.J.getActiveGrid();if(a){var b=pw(this.J),c=tC(b),d=ebc(this,c||[]),e=ebc(this,this.Ua||[]);d&&!e||!d&&!fbc(c,this.Ua)?(this.F=null,this.Na=!0):this.Na=!1;this.Ua=c;var g=wC(b).clone();A(tC(b),function(a){vh(g,a)});this.Y=new Jh(a.fb(),"",g)}else this.Y=null};
q.h2a=function(a){this.va=wJ(this.R,ij.ova);var b=this.J.getActiveGrid(),c=this.Y&&this.Y.xd;if(!b||b.fb()!=c||null===c)return this.Y=null;var d=this.J.getActiveGrid().D,b=nA(d,this.Y.rect);b.addCallback(function(){if(!this.J.getActiveGrid()||jw(this.J)!=c)return null;var b=pw(this.J),g=qA(b,this.Y.rect,fc(Ug),a?void 0:500),h=jA(b.F,"r"),k=b.Om("r");return!b.Lt(g)||h>=g.hc()&&WIa(b)||k<=g.Wc()&&VIa(b)?(this.dispatchEvent(new K("ls")),pA(d,g,fc(Ug),a?void 0:500).addCallback(this.C4a,this)):g},this);
b.addCallback(function(a){var b=this.J.getActiveGrid();return a&&b&&b.fb()==c&&null!==c?gbc(this,a,pw(this.J)):null},this);b.addCallback(function(b){b=b&&new Jh(c,"",b);if(null===b&&null!==this.C||null!==b&&!b.equals(this.C))this.F=this.D=this.O=this.$=null;var d=null!==b&&b.equals(this.C);if(d=this.Ka||this.Na||!d&&(null===this.O||null!==this.D&&null===this.F))this.wb=this.Da&&this.wb||!this.C||!b||!b.rect.intersects(this.C.rect);var e=null!==b&&b.contains(this.C);this.C=b;""!=this.va&&(xJ(this.R,
this.va),this.va="");d&&(a&&(this.ea=wJ(this.R,ij.pva)),this.L.cancel(!0),this.L=Pj(),this.L.addCallback(this.o2a,this),this.L.addCallback(this.z4a,this),a&&(this.L.addCallback(Da(this.v4a,e),this),this.$a&&!hw(this.jc.F)&&xoa?this.L.addCallback(this.Idb,this):(this.L.addCallback(this.l2a,this),this.L.addCallback(this.m2a,this)),this.L.addCallback(this.u4a,this)),Lj(this.L,this.qib,this))},this);return b};
q.o2a=function(){if(null!==this.C&&null!==this.C.rect&&null===this.$){var a=wJ(this.R,ij.aua);this.$=ritz.getAssistantConfidence(""+this.C.xd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,this.Pa.serialize(this.X));xJ(this.R,a)}};q.C4a=function(){this.dispatchEvent(new K("le"))};q.z4a=function(){this.dispatchEvent(new hbc(this.C,this.$))};q.v4a=function(a){a=new ibc(a,this.Ka);this.Ka=!1;this.dispatchEvent(a)};
q.Idb=function(){if(null===this.C||null===this.C.rect||null!==this.D&&null!==this.F)return null;J(this.La);var a=wJ(this.R,ij.rva),b=jbc(this),c=b&&!b.OMa,b=ritz.getAssistantRequestProto(this.C.xd.toString(),this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left,c?b.rows:[],c?b.Ae:[]),b=this.Pa.td(gW.Ca(),b),c=new Ii;c.vv=!0;var b=Ui(c.serialize(b)),d=new Ij;this.La=qj(rj(oj(mma(Vk(this.$a.Cf("/explore/getrecommendations").Ff("rp",b),"GET")).setTimeout(6E4),
1),function(b){var c=wJ(this.R,ij.qva);b=kbc(this,b.Mf());xJ(this.R,c);this.D=Cc(b,1);this.F=Cc(b,2);this.La=null;xJ(this.R,a);d.Lb()},this),function(){this.D=[];this.F=[];d.Lb()},this).Te();return d};
q.l2a=function(){function a(){b=null;ritz.continueAssistantRecommendation(this.O)?(this.D=Cc(kbc(this,ritz.getAssistantRecommendations(this.O)),1),d.Lb()):b=Zk(a,5,this)}if(null===this.C||null===this.C.rect||null!==this.O&&null!==this.D)return null;this.O=ritz.newAssistantRecommender(this.Pa.serialize(this.X));this.F=this.D=null;ritz.startAssistantRecommendation(this.O,""+this.C.xd,this.C.rect.top,this.C.rect.height+this.C.rect.top,this.C.rect.left,this.C.rect.width+this.C.rect.left);var b=null,c=
y(function(){null!==b&&($k(b),this.F=this.D=this.O=b=null)},this),d=new Ij(c),b=Zk(a,5,this);return d};q.m2a=function(){var a=jbc(this);a&&this.O&&null===this.F&&(this.F=a.OMa?[]:Cc(kbc(this,ritz.getAssistantRecommendationsOnlySelection(this.O,a.rows,a.Ae)),2))};
q.u4a=function(){this.Da=!1;var a=this.F&&0<this.F.length,b=a?this.F:this.D,b=sb(b||[],function(a){return.4<=a.getConfidence()});b.length=Math.min(b.length,10);0==b.length&&!a&&this.D&&0<this.D.length&&.7<=this.$&&(b=[this.D[0]]);""!=this.ea&&(xJ(this.R,this.ea),this.ea="");this.dispatchEvent(new lbc(this.C,b,this.wb))};function kbc(a,b){return a.Pa.td(fW.Ca(),b)}
function gbc(a,b,c){b=b.clone();dc(Ug,function(a){for(var d=!0;d&&b;){for(var g=Yg(a),h=0;h<(g?b.width:b.height);h++){var k=Dh(b,a),l=g?b.bc():b.hc();if(g&&!UIb(c.sf(k,l+h))||!g&&!UIb(c.sf(l+h,k))){d=!1;break}}d&&(gha(b,-1,a),0==b.width||0==b.height)&&(b=null)}return!!b},a);return b}function fbc(a,b){return Ub(a,b,function(a,b){return wh(a,b)})}
function jbc(a){var b=a.J.getActiveGrid();if(!b||!a.C||b.fb()!=a.C.xd)return null;for(var c=tC(pw(a.J)),c=tb(c,Da(uh,a.C.rect)),c=sb(c,pa),d=tb(c,function(a){return new kh(a.left-this.C.rect.left,a.top-this.C.rect.top,a.width,a.height)},a),b=new og,e=new og,g=0;g<d.length;g++){for(var h=0;h<d[g].width;h++)e.add(d[g].left+h);for(h=0;h<d[g].height;h++)b.add(d[g].top+h)}a=ebc(a,c);return{rows:b.Fd(),Ae:e.Fd(),OMa:a}}
function ebc(a,b){a.J.getActiveGrid();if(0==b.length)return!0;if(1!=b.length)return!1;b=b[0];if(xh(b)||0==Hh(b))return!0;a=EMa(pw(a.J).X,b.top,b.left);return b.equals(a)}function hbc(a,b){K.call(this,"cu");this.C=a;this.F=b}z(hbc,K);hbc.prototype.getConfidence=f("F");function lbc(a,b,c){K.call(this,"ce");this.C=a;this.F=b;this.Y=c}z(lbc,K);function ibc(a,b){K.call(this,"cs");this.C=a;this.F=b}z(ibc,K);function RW(a,b,c,d,e,g){tU.call(this,g);this.Na=a;this.Gb=b.C;this.La=c;this.Qc=d;this.L=e;this.Y=new PW(b,c,d,e,this.oa);this.Ma(this.Y);this.R=new LV(!1,"#4285f4");this.Ma(this.R);this.O=null;this.mb=this.eb=!1;this.Ya=!0;this.Ua=vJ.getInstance();this.ea=this.$="";this.Uc=Ro(new Qo,10).Ga()}z(RW,tU);q=RW.prototype;q.Sa=function(){RW.Z.Sa.call(this);this.Ba=Gr(this.Cta(),{KNb:lm});wp(this.Ba,"waffle-assistant-sidepanel")};q.Cta=v;
q.Fa=function(){RW.Z.Fa.call(this);var a=T(this,"waffle-assistant-quicksum-panel");this.Y.Va(a);a=T(this,"waffle-assistant-spinner-container");this.R.render(a);this.getHandler().V(this,"close-sidebar",this.oma).V(this.Na,cbc.RYa,this.bma).V(this.Na,cbc.QYa,this.ama).V(this.Na,cbc.pWa,this.Cla).V(this.Na,cbc.oWa,this.Bla).V(T(this,"waffle-assistant-scroll-pane"),"scroll",Z8b(this.h1,10,this));a=X.HG.isEnabled();this.Bca(!a)};
q.resize=function(){var a=T(this,"waffle-assistant-sidepane-content"),a=Vp(a).height,b=T(this,"waffle-assistant-spinner-container");Dp(b,"margin-top",a/2-16+"px")};q.lh=ma;function mbc(a,b){var c=a.vG();0!=c.length&&(J(a.O),c=c.filter(function(a){return a instanceof oW}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.O=new QW(c,b,a.oa),a.O.render(),H(a,a.O),Xac(a.O,a.mb)))}
q.Bca=function(a){this.mb=a;Ap(this.Ba,"waffle-assistant-readonly",a);var b=this.Y;b.O=a;b.C&&(b.C.J=a);Ap(b.Ba,"waffle-assistant-quicksum-panel-readonly",a);this.O&&!this.O.isDisposed()&&Xac(this.O,a)};q.setVisible=function(a){var b=this.Ta();RW.Z.setVisible.call(this,a);a&&!b&&(this.ea=wJ(this.Ua,ij.uva),this.R.setActive(!0),SW(this));a||this.nT(!0)};q.bma=function(){this.Ta()&&(this.nT(!0),this.R.setActive(!0),SW(this))};q.ama=function(){this.Ta()&&(this.R.setActive(!1),SW(this))};
q.Cla=function(a){this.Ta()&&(this.L.Pb(2775,this.Uc),this.nT(void 0,a.C,a.F),this.B9()||this.R.setActive(!0),SW(this),this.Ya=!1)};q.Bla=function(a){if(this.Ta()){this.L.Pb(2776,this.Uc);var b=a.F;0<b.length&&(this.$=wJ(this.Ua,ij.tva));this.nT(!1);this.R.setActive(!1);this.Bta(b,a.C);a=a.Y;b=this.vG();0<b.length&&this.eb&&(b[b.length-1].Rb=!0);this.eb=!1;SW(this);this.Dta(a);this.h1()}};q.Bta=v;q.Dta=v;q.nT=v;q.rja=v;
function SW(a){var b=a.B9(),c=Zp(T(a,"waffle-assistant-quicksum-panel")),d=a.R.Ob(),b=b||c||d,c=a.rja();a=T(a,c);R(a,!b)}q.B9=v;q.h1=v;q.vG=v;q.tGa=Jf;function nbc(a){return T(a,"waffle-assistant-scroll-pane").scrollTop+Vp(T(a,"waffle-assistant-sidepane-content")).height}q.Fc=ma;q.Id=f("mb");q.oma=function(){this.L.Pb(2226,this.Uc)};q.BEb=function(){""!=this.$&&(xJ(this.Ua,this.$),this.$="");""!=this.ea&&(xJ(this.Ua,this.ea),this.ea="");this.Ya||(this.L.Pb(2777,this.Uc),this.Ya=!0)};function obc(a){return V('<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0" y="0" height="'+W(a.iconSize)+'px" width="'+W(a.iconSize)+'px" viewBox="0 0 24 24" preserveAspectRatio="none"><path fill="'+W(a.color)+'" d="M19,2 L5,2 C3.9,2 3,2.9 3,4 L3,18 C3,19.1 3.9,20 5,20 L9,20 L12,23 L15,20 L19,20 C20.1,20 21,19.1 21,18 L21,4 C21,2.9 20.1,2 19,2 L19,2 Z M13.88,12.88 L12,17 L10.12,12.88 L6,11 L10.12,9.12 L12,5 L13.88,9.12 L18,11 L13.88,12.88 L13.88,12.88 Z"/></svg>')}
;function pbc(a,b,c){a=a||{};c=c||{};b=V;var d=cs(""+qbc()),e;e=c||{};e=V(""+('<div class="waffle-assistant-empty-list-old" style="'+(e.bb?"/*"+e.bb+"*/":"")+'display: none"><img src="//ssl.gstatic.com/docs/spreadsheets/bulbman.svg" /><div aria-live="polite"><div class="waffle-assistant-empty-list-title-old">Nothing interesting here right now</div><div class="waffle-assistant-empty-list-body-old">Try selecting different data. Information with numbers works best.</div></div><a href="https://support.google.com/docs/?p=explore_sheets" target="_blank">Learn more</a><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try an example</a></div>'));
return b(U(DU($r({title:d,Kj:cs('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.bb?"/*"+c.bb+"*/":"")+'display: none"></div><div class="waffle-assistant-card-holder"></div></div></div>'),id:bs("autovis"),F0:bs("waffle-assistant-title"),aO:bs("waffle-assistant-sidepane-content")},a))))}
function rbc(a,b,c){a=a||{};b=V;var d=cs('<div class="waffle-assistant-replaceable-title">'+qbc()+"</div>"),e;e=a||{};c=c||{};var g=V,h=c;e=e||{};h=h||{};h=""+('<div class="waffle-assistant-empty-list" style="'+(h.bb?"/*"+h.bb+"*/":"")+'display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+U(obc({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">Get insights instantly</div><div class="waffle-assistant-empty-list-body">');h=e.KNb?
h+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":h+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.";e=V(h+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">Try it out</a></div></div></div>');
c=g('<div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="'+(c.bb?"/*"+c.bb+"*/":"")+'display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="'+(c.bb?"/*"+c.bb+"*/":"")+'display: none"></div></div></div>');return b(U(DU($r({title:d,
Kj:cs(""+c),id:bs("autovis"),F0:bs("waffle-assistant-title"),aO:bs("waffle-assistant-sidepane-content")},a))))}function qbc(){return V('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+U(obc({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+U("Explore")+"</div></div>")};function TW(a,b,c,d,e,g,h){RW.call(this,a,b,c,d,e,h);this.Za=g;this.X=new pq(this.oa);this.Ma(this.X);this.J=new Rac;H(this,this.J);this.D=[];this.F=null;this.Da=new kt("",h,4);jr(this.Da,2);this.Ma(this.Da)}z(TW,RW);
var UW={ez:"waffle-assistant-scroll-pane-feature-content",AXa:"waffle-assistant-empty-list",RXa:"waffle-assistant-features",JYa:"waffle-assistant-empty-list-learn-more",Oda:"waffle-assistant-expanded-panel",$Za:"waffle-assistant-replaceable-title",qkc:"waffle-assistant-scroll-pane",hN:"waffle-assistant-title"},sbc={defaultHelpArticleId:"6280499"};q=TW.prototype;q.Cta=function(){return rbc};q.rja=n("waffle-assistant-empty-list");
q.Fa=function(){TW.Z.Fa.call(this);this.X.Va(T(this,UW.Oda));UV(this.C.Ba,"Close");if(lm){var a=new JW(this.Za,this.La,this.Gb,this.Qc,this.L,this.J,this.oa);this.Ma(a);this.D.push(a)}if(Aoa||Boa)a=new Qac(this.L,this.J,this.oa),this.Ma(a),this.D.push(a);a=new sW(this.Gb,this.La,this.L,this.J,this.oa);this.Ma(a);this.D.push(a);var b=T(this,UW.RXa);A(this.D,function(a){a.render(b);this.X.Ma(a.D,!0)},this);this.Da.Va(T(this,UW.JYa));this.getHandler().V(this.Da,"action",this.MVb);tbc(this)};q.MVb=function(){Q.$n.Xb(sbc)};
q.Bta=function(a,b){for(var c=0;c<this.D.length;c++){for(var d=[],e=0;e<a.length;e++){var g=Dc(a[e],1);this.D[c].Q3(g)&&d.push(a[e])}0<d.length&&this.D[c].zta(d,b)}};q.Dta=function(){A(this.D,function(a){j9b(a)})};q.nT=function(a,b,c){A(this.D,function(d){d.e1(a,b,c)})};q.B9=function(){return!!xb(this.D,function(a){return a.Bma()})};q.h1=function(){var a=nbc(this);A(this.D,function(b){this.F&&this.F!=b||(b instanceof sW&&Df(this.getHandler(),b,"assistant-done-rendering",this.BEb),a=b.Ata(a))},this)};
q.vG=function(){if(this.F)return this.F.D.D;var a=[];A(this.D,function(b){Lb(a,i9b(b))});return a};q.Bca=function(a){TW.Z.Bca.call(this,a);tbc(this)};q.lh=function(a){A(this.D,function(b){b.lh(a)})};
q.Fc=function(){var a=T(this,UW.ez),b=T(this,UW.$Za),c=T(this,UW.hN),d=this.X.Ba;if(this.F)this.F.D.setVisible(!1),this.F.setActive(!1),this.F=null,R(a,!0),R(d,!1),Er(b,qbc),this.resize();else if(this.F=xb(this.D,function(a){return a.Ob()}))R(a,!1),R(d,!0),this.F.D.setVisible(!0),k9b(this.F,b);Up(c,Vp(b).height);Zk(function(){var a=Sv;a&&a.dispatchEvent("resize");this.h1()},150,this)};q.setVisible=function(a){var b=this.Ta();TW.Z.setVisible.call(this,a);a&&!b&&ubc(this,!0);a||this.J.clear()};
q.oma=function(){TW.Z.oma.call(this);this.F&&this.Fc()};q.bma=function(){TW.Z.bma.call(this);ubc(this,!0)};q.ama=function(){TW.Z.ama.call(this);ubc(this,!1)};q.Cla=function(a){TW.Z.Cla.call(this,a);ubc(this,!0,a.C)};q.Bla=function(a){TW.Z.Bla.call(this,a);ubc(this,!1)};function tbc(a){A(a.D,function(a){a.g1(this.Id())},a)}q.tGa=f("D");function ubc(a,b,c){A(a.D,function(a){c||e9b(a.D,b)})};function vbc(a){var b;a=a||{};return V('<div class="docs-explore-promo-base '+W(a.Vf)+'"><div class="docs-explore-promo-content">'+(a.HE?'<div class="docs-explore-promo-header">'+U(null==(b=a.HE)?"":b)+"</div>":"")+'<div class="docs-explore-promo-description">'+U(null==(b=a.pW)?"":b)+'<div class="docs-explore-promo-buttons">'+(a.mI?U(jt({Oe:"docs-explore-promo-button docs-explore-promo-continue-button",content:cs(""+U(a.mI)),style:4})):"")+(a.vO?U(jt({Oe:"docs-explore-promo-button docs-explore-promo-close-button",
content:cs(""+U(a.vO)),style:4})):"")+"</div></div></div>"+(a.VLa?V('<div class="docs-explore-promo-icon-wrapper"><div class="docs-explore-promo-icon">'+U(obc({color:a.VLa,iconSize:"32"}))+"</div></div>"):"")+"</div>")};function wbc(a,b,c,d){pq.call(this,d);this.J=new kt("",d);this.Ma(this.J);this.C=new kt("",d);this.Ma(this.C);this.D=new kt("",d);jr(this.D,2);this.Ma(this.D);this.O=c;this.L=a;this.F=b}z(wbc,pq);q=wbc.prototype;q.Sa=function(){this.Ba=Gr(vbc,this.O)};
q.Fa=function(){wbc.Z.Fa.call(this);this.jAa();var a=T(this,"docs-explore-promo-continue-button");a&&this.J.Va(a);(a=T(this,"docs-explore-promo-close-button"))&&this.C.Va(a);(a=T(this,"docs-explore-promo-icon"))&&this.D.Va(a);this.getHandler().V(ja,"resize",Mf(y(this.jAa,this))).V(this.J,"action",this.TCa).V(this.C,"action",this.J5a).V(this.D,"action",this.Zob)};
q.jAa=function(){var a=this.Ba,b=Vp(this.L),b=Math.max(b.height,b.width)+50;Sp(a,new hh(b,b));var b=Qp(this.L,document.body),c=-this.F;Jp(a,b.translate(c,c));Dp(a,{borderWidth:this.F+"px",borderRadius:2*this.F+"px"})};q.TCa=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};q.J5a=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};q.Zob=function(a){this.TCa(a)};function xbc(a){return V('<div class="waffle-assistant-walkthrough-promo-content"><h1 class="waffle-assistant-walkthrough-promo-header">'+U(a.HE)+'</h1><p class="waffle-assistant-walkthrough-promo-description">'+U(a.pW)+"</p>"+(a.mI?U(jt({Oe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-continue-button",content:cs(""+U(a.mI)),style:4})):"")+(a.vO?U(jt({Oe:"waffle-assistant-walkthrough-promo-button waffle-assistant-walkthrough-promo-close-button",content:cs(""+U(a.vO)),
style:4})):"")+"</div>")};function VW(a,b,c){XE.call(this,a,c);this.J=new kt("",c);this.C=new kt("",c);a=Gr(xbc,b);this.setContent(a);this.Eg("docs-promo-bubble");this.setPosition(0,0);this.F.py=!0;Bq(this.D,!1);this.bv=!1}z(VW,XE);VW.prototype.Fa=function(){VW.Z.Fa.call(this);var a=T(this,"waffle-assistant-walkthrough-promo-continue-button");a&&this.J.Va(a);(a=T(this,"waffle-assistant-walkthrough-promo-close-button"))&&this.C.Va(a);this.getHandler().V(this.J,"action",this.R).V(this.C,"action",this.O)};
VW.prototype.R=function(a){this.dispatchEvent("promo-continue");a.stopPropagation()};VW.prototype.O=function(a){this.dispatchEvent("promo-dismiss");a.stopPropagation()};function ybc(a){var b=Km("waffle-assistant-chart-preview",void 0);VW.call(this,b,{HE:"See the big picture",pW:"Data visualizations and text summaries make it easier to spot trends and outliers.",mI:"Got it"},a)}z(ybc,VW);function zbc(a,b){var c=Km("waffle-assistant-answers-input",void 0),d;d=new Tv;a="Interested in the "+(d.Am("b")+(a+(d.Mm("b")+"? Ask a question about your data to learn more, no formulas needed.")));d={HE:"Find answers in a snap",pW:d.format(a),mI:"Next",vO:"Dismiss"};VW.call(this,c,d,b)}z(zbc,VW);function Abc(a,b){var c=Km("waffle-assistant-entry",void 0);wbc.call(this,c,400,{Vf:"waffle-assistant-entry-promo",HE:"Get insights instantly",pW:a.startsWith("en")?"Find answers to questions about your data, apply formatting, and create charts in a single click using Sheets Explore.":"Apply formatting and create charts over your data in a single click using Sheets Explore.",mI:"Check it out",vO:"Dismiss",VLa:"#0F9D58"},b)}z(Abc,wbc);function Bbc(a){var b=Km("waffle-assistant-banding-recommendation",void 0);VW.call(this,b,{HE:"Make it pop",pW:"Quickly apply alternating row color formatting to add style, polish, and visual appeal.",mI:"Next",vO:"Dismiss"},a)}z(Bbc,VW);function Cbc(a,b,c,d,e,g,h,k,l){zU.call(this,b,h);this.Ka=a;this.C=b;this.$=c;this.Ha=d;this.Ua=e;this.X=g;this.Pa=k;this.O=c.C;this.Da=this.va=!1;this.J=l;this.D=null;this.wb=new Ii;this.L=null;a=nw(this.Ua);this.qa.V(this.Ha,"selectionChange",this.OVb).V(this.O,"Sa",this.NVb).V(a,"kb",this.Orb).V(this.C,"assistant-sidepane-apply-conditional-format-rules",this.uhb).V(this.C,"assistant-sidepane-apply-banding",this.thb).V(this.C,"assistant-sidepane-remove-banding",this.Svb).V(this.C,"assistant-sidepane-change-selection",
this.Iib).V(this.C,"assistant-sidepane-insert-chart",this.Ipb).V(this.C,"assistant-sidepane-thumbs",this.Hyb).V(this.C,"assistant-sidepane-set-active-panel",this.Cxb).V(this.C,"assistant-sidepane-back-button-clicked",this.Ohb).V(this.C,"assistant-undo-pressed",this.PVb).V(this.Ka,"cu",this.bkb);Oo(this.R,X.HG,Zn,this.Lpb).subscribe(X.zT,"action",this.Mhb).subscribe(X.u1,"action",this.uyb).subscribe(X.Kca,"action",this.pyb);X.t1.Qa(!0);this.Uc=Ro(new Qo,10).Ga();this.La=vJ.getInstance();this.ea=wJ(this.La,
ij.sva);Zk(Da(this.XV,!1),100,this)}z(Cbc,zU);q=Cbc.prototype;q.Fh=function(){return X.Mca};q.Ss=function(){return X.Nca};q.ls=function(a){Cbc.Z.ls.call(this,a);X.u1.Qa(a);this.XV(!1);!this.va&&a&&(this.va=!0,Hoa&&wK(this.Pa,"ritz-DisplayExploreV2Promo",!1))};q.lh=function(a){this.C.lh(a);this.Ka.lh(a)};q.Mhb=function(){var a=this.C.Ta();this.Fh().setVisible(!a);a?this.J.Pb(2226,this.Uc):(this.C.focus(),this.J.Pb(2253,this.Uc))};q.pyb=function(){this.C.Ta()||this.ls(!0)};
q.uyb=function(a){mbc(this.C,a)};q.OVb=function(){this.XV(!0);this.D&&(J(this.D),this.D=null)};q.XV=function(a,b){if(b){if(!b.length)return;if(1==b.length&&this.L&&b[0].equals(this.L)){this.L=null;return}}var c=this.C;c.Ta()&&(Tac(c.Y),SW(c));this.Ka.update(!a,this.C.Ta(),b)};
q.bkb=function(a){""!=this.ea&&(xJ(this.La,this.ea),this.ea="");var b=a.getConfidence()||0;a=a.C;var c=!!a&&a.rect,d=(c=!!c&&50<=Hh(c)&&5<=Ch(c,"r")&&3<=Ch(c,"c")&&5E4>=Hh(c))&&.6<=b;d!==this.Da&&(this.Da=d,X.t1.Xb(d));c&&(a&&a.rect?(c=.9<=b,d=1E3>=Hh(a.rect),a=ritz.isFormsRegion(""+a.xd,a.rect.top,a.rect.left,a.rect.height+a.rect.top,a.rect.width+a.rect.left),c=xoa&&!this.C.Ta()&&!this.va&&c&&d&&!hw(this.$.F),a=yoa&&a,d=zoa&&this.$.Id(),c&&(a||d)?(c=new W8b,P(c,1,b),P(c,2,a),P(c,3,d),a=new co,cj(a,
58,c),this.Sza(new Po(10,a)),a=!0):a=!1):a=!1,!a&&Hoa&&.6<=b&&!this.C.Ta()&&!this.va&&!this.D&&this.Pa.C["ritz-DisplayExploreV2Promo"].Ia()&&(b=this.$.$.Mx(),this.D=new Abc(b),H(this,this.D),this.D.render(),Df(Df(this.qa,this.D,"promo-dismiss",this.hma),this.D,"promo-continue",this.Tmb),wK(this.Pa,"ritz-DisplayExploreV2Promo",!1),this.J.Pb(2788,this.Uc)))};
q.Sza=function(a){this.C.eb=!0;var b=fOa(pw(this.O));eKb.C||b||(a=a||this.Uc,this.Fh().setVisible(!0),this.J.Pb(2225,a),Zk(Da(this.E2a,a),5E3,this))};q.E2a=function(a){this.C.Ta()||this.J.Pb(2752,a)};q.hma=function(){J(this.D);this.D=null};
q.Tmb=function(){J(this.D);this.ls(!0);Df(this.qa,this.C,"assistant-done-rendering",y(function(){var a;a:{this.C.Ta();for(var b=a=!1,c=!1,d=this.C.vG(),e=0;e<d.length;e++)if(d[e]instanceof xW?a=!0:d[e]instanceof KW?b=!0:d[e]instanceof oW&&(c=!0),a&&b&&c){a=!0;break a}a=!1}a?this.lKa():this.hma()},this))};
q.lKa=function(){this.C.Ta();J(this.D);var a=null;this.D instanceof Abc?(a=this.C.tGa(),a=wac(xb(a,function(a){return a instanceof JW}).L).toLowerCase(),a=new zbc(a)):this.D instanceof zbc?a=new Bbc:this.D instanceof Bbc&&(a=new ybc);if(this.D=a)H(this,this.D),this.D.render(),Df(Df(this.qa,this.D,"promo-dismiss",this.hma),this.D,"promo-continue",this.lKa)};q.Ohb=function(){this.C.Fc()};
q.PVb=function(a){var b=a.C,c=b.D.lJ(),d=parseInt(c.fb(),10);this.L=Oh(c);this.X.C(new YKb(d));Nac(b,c);this.J.Pb(a.Dj(),this.Uc)};q.NVb=function(){ow(this.O)?(this.C.Qa(!0),this.XV(!1)):(this.Fh().setVisible(!1),this.C.Qa(!1))};q.Lpb=function(){this.C.Bca(!X.HG.isEnabled())};q.Orb=function(a){this.XV(!1,a.C?a.C:a.rect?[a.rect]:[])};
q.uhb=function(a){var b=pw(this.O),c=""+b.mc(),d=[],e=L4b(b);if(e){var b=new Ve,g=Dc(e,2);F(b,3,g);g=Dc(e,2);F(b,2,g);e=Dc(e,1);F(b,1,e);d.push(b)}b=a.C.mb;for(e=0;e<b.length;e++)g=new Ve,F(g,2,b[e]),d.push(g);this.X.C(new EU(d,c));a=a.Dj();this.J.Pb(a,this.Uc)};
q.thb=function(a){var b=a.C,c=y5b(b.C),d=b.D.lJ(),e=c.Gt?c.hw:null,g=c.C?c.Uv:null,h=parseInt(d.fb(),10),k=Dbc(d);this.L=Oh(d);k?this.X.C(new yU(k,h,this.L,e,c.xr,c.gs,g)):this.X.C(new wU(h,this.L,e,c.xr,c.gs,g));d=new Y4b;P(d,1,1);c=new ST;b=b.D.getConfidence();P(c,2,b);cj(c,5,d);b=new co;cj(b,46,c);b=new Po(10,b);a=a.Dj();this.J.Pb(a,b)};q.Svb=function(a){a=a.C;var b=a.D.lJ(),c=parseInt(b.fb(),10),d=Dbc(b);this.L=Oh(b);this.X.C(new xU(d,c));Nac(a,b)};
function Dbc(a){var b=a.fb();a=Oh(a);b=ritz.getWorkbookRangeIntersectingIds(b,a.hc(),a.bc(),a.Wc(),a.fd(),7,!1);return 0<b.length?b[0]:null}q.Iib=function(a){CC(pw(this.O),a.F);a=a.Dj();this.J.Pb(a,this.Uc)};
q.Hyb=function(a){var b=a.C;a=a.Dj();if(b instanceof vW||b instanceof xW)this.J.Pb(a,this.Uc);else{var c=this.C.vG(),d=new ST,e=b.D.getConfidence(),c=c.indexOf(b);P(d,1,c);P(d,2,e);e=new co;cj(e,46,d);if(b instanceof oW){(d=b.L)?(b=Ebc(this,b,d),b=j8b(b,d,d.Sg)):b=null;if(!b)return;cj(e,39,b)}else if(b instanceof rW){var g=b.D,c=new Y8b;if(b instanceof rW)b=1;else throw Error("Unknown text analysis card type.");g=Cc(g.getAutovisRecommendation(),20).slice(0,10);P(c,2,g||[]);P(c,1,b);cj(d,3,c)}this.J.Pb(a,
new Po(10,e))}};q.Cxb=function(){this.C.Fc()};
q.Ipb=function(a){var b=a.Y;if(b){var c=pw(this.O),d=a.Ve();d||(d=Xz(this.Ha).ud().C.Ve());var e=16,g=16,h=a.wb;h&&(e=h.x,g=h.y);c={oid:null,ar:JC(c,d.y),ac:KC(c,d.x),x:e,y:g,h:JGa.height,w:JGa.width,p:{context:{chartName:"Chart "+(Fbc(this)+1)}}};d=new NH(jw(this.O)||0,c,!1,!1);c=b.Sg;e=new Al(c);g=Ml(e,"headers");g=null!=g&&va(g)&&Ra(g)?parseInt(g,10):-1;d.Pa=g;d.va=0;g="1"==Ml(e,"transpose");d.Ka=g;d.O=g?"ROWS":"COLS";g=Ml(e,"range");g=P4b(O4b(g,","),this.O);d.yS(g);V3b(d,b);if(e=Ml(e,"dt"))e=
this.wb.td(bf.Ca(),JSON.parse(decodeURIComponent(e))),d.R=encodeURIComponent(JSON.stringify(d.Ua.serialize(e)));this.Ha.dispatchEvent(new PE("objectRequest"));this.X.C(new IE(this.$,d));e=Gbc(this,b,a.$,a.Se());d=this.J;a=a.Dj();b=j8b(e,b,c);c=new co;cj(c,39,b);d.Pb(a,new Po(10,c))}};function Ebc(a,b,c){var d=a.C.vG().filter(function(a){return a instanceof oW});return Gbc(a,c,d.indexOf(b),b.L&&b.L.Se())}
function Gbc(a,b,c,d){var e=new l8b;a=a.C.vG().filter(function(a){return a instanceof oW}).map(function(a){return a.getChartType()});e.R=a;e.F=c;m8b(e,b.getChartType());e.D=d?d.clone():null;return e}function Fbc(a){var b=0;fG(a.$.J,function(a){6==a.getType()&&b++});return b};function Hbc(a,b){mW.call(this,a,b)}z(Hbc,mW);q=Hbc.prototype;q.Xy=function(a){a()};q.Qy=ma;q.Lx=n("assistantPivotTableFeedback");q.dE=n(2632);q.cE=n(2631);function Ibc(a,b,c,d,e,g,h){RW.call(this,a,b,c,d,e,h);this.J=new pq(this.oa);this.Ma(this.J);this.F=null;this.Da=new M;H(this,this.Da);this.D=[];this.Za=null;this.X=!0}z(Ibc,RW);var Jbc={rWa:"waffle-assistant-card-holder",ez:"waffle-assistant-sidepane-content",uXa:"waffle-assistant-dragger-card",tXa:"waffle-assistant-dragged-card",AXa:"waffle-assistant-empty-list-old",VISIBLE:"waffle-assistant-visible"};q=Ibc.prototype;q.Cta=function(){return pbc};q.rja=n("waffle-assistant-empty-list-old");
q.Fa=function(){Ibc.Z.Fa.call(this);var a=T(this,Jbc.rWa);this.J.Va(a)};q.setVisible=function(a){var b=this.Ta();Ibc.Z.setVisible.call(this,a);a&&!b&&(this.X=!0)};
q.Bta=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=D(c,1),e=null;switch(d){case 0:"WordCloud"==c.getAutovisRecommendation().getChartType()?e=new rW(c,this.oa):e=new oW(c,this.Gb,this.La,this.L,null,this.oa);break;case 1:e=new Hbc(c,this.oa);break;case 2:e=new LW(c,this.oa);break;case 4:e=new KW(c,this.L,this.oa);break;default:throw Error("Unsupported recommendation type: "+d);}c=this.J.od();e.Y=c;this.J.Ma(e,!0);if(X.HG.isEnabled()){if(!this.F||this.F.isDisposed())this.F=new Kbc,A5b(this.F,
this.J.Ba),this.F.X=10,this.F.R=Ua(Jbc.uXa).split(" "),this.F.ea=!0,this.F.Nqa(Jbc.VISIBLE),this.F.L=!1,this.F.We(),this.Da.V(this.F,"beforedragstart",y(this.QVb,this)).V(this.F,"dragstart",y(this.RVb,this)).V(this.F,"beforedragend",y(this.Yhb,this));var c=this.F,d=this.J.Ba,g=e.Ba;u(void 0)?tpa(d,g,void 0):d.appendChild(g);B5b(c,g)}0!=this.D.length&&e.getHandler().V(this.D[this.D.length-1],"content-rendered",e.jO);this.D.push(e)}};
q.Dta=function(a){0<this.D.length&&this.D[0].jO();if(a||this.X)this.X=!1,Lbc(this)};function Lbc(a){if(0!=a.D.length){for(var b=0,c=0;c<a.D.length;c++){var d=a.D[c].Ba;Jp(d,0,1E3);b+=Vp(d).height}b=Math.max(Vp(T(a,"waffle-assistant-sidepane-content")).height,b);Up(a.J.Ba,b);for(c=0;c<a.D.length;c++)Zk(Da(a.i1a,a.D[c]),100*c,a);Zk(function(){Up(this.J.Ba,"auto")},100*a.D.length,a)}}q.i1a=function(a){!a.isDisposed()&&this.isEnabled()&&(new jU(a.Ba,[0,1E3],[0,0],100)).play()};
q.nT=function(){this.Da.Gc();J(this.F);for(var a=0;a<this.D.length;a++){var b=this.D[a];b.rc()&&this.J.removeChild(b,!0);J(b)}this.D=[]};q.B9=function(){return 0<this.D.length};q.h1=function(){for(var a=nbc(this),b=0,c=0;c<this.D.length;c++)b<a?(WV(this.D[c],!0),b+=Vp(this.D[c].Ba).height):WV(this.D[c],!1)};q.QVb=function(a){var b=qb(this.J.Ba.childNodes,a.C),b=this.J.Ad(b);b.EMa()?this.Za=b:a.preventDefault()};q.RVb=function(a){wp(a.F,Jbc.tXa)};
q.Yhb=function(a){var b=Kp(a.F),c=Xz(this.La).C;if(mh(sE(c,"page",!1,!1)).contains(b)){var d=qE(c,b.x,b.y,"page"),c=uE(c,sh(d),"page");this.Za.r8(d,new N(b.x-c.left,b.y-c.top))}a.Y.ew(null,!0);a.preventDefault();this.Za=null};q.vG=f("D");function Kbc(){FU.call(this)}z(Kbc,FU);Kbc.prototype.uka=function(a){a=Kbc.Z.uka.call(this,a);var b=tb(a.querySelectorAll("clippath"),function(a){return a.id});Mbc(a,b);return a};
function Mbc(a,b){for(var c=a.getAttribute&&a.getAttribute("clip-path"),d=0;d<b.length;d++){var e=b[d];va(c)&&ab(c,e)&&a.setAttribute("clip-path",c.replace(e,e+"-clone"));e==a.id&&(a.id=e+"-clone")}a=$m(a);for(d=0;d<a.length;d++)Mbc(a[d],b)};function Nbc(){G.call(this)}z(Nbc,En);Nbc.prototype.C=function(){return bbc};Nbc.prototype.F=function(){return Aoa||Boa||lm?TW:Ibc};Nbc.prototype.D=function(){return Cbc};Mn("assistant",Nbc);
